function News(){this.progressGroup=$("#progress-group")}News.prototype.run=function(){var e=this;e.listenQiniuFileUploadEvent(),e.initUeditor(),e.listenAddNewsEvent()},News.prototype.initUeditor=function(){window.ue=UE.getEditor("container",{initialFrameHeight:500,serverUrl:"/ueditor/upload/"})},News.prototype.listenAddNewsEvent=function(){$("#submit-btn").click(function(e){e.preventDefault();var o=$(this).attr("data-news-id"),t="";t=o?"/cms/edit_news/":"/cms/write_news/";var n=$("input[name='title']").val(),s=$("select[name='category']").val(),r=$("input[name='desc']").val(),i=$("input[name='thumbnail']").val(),a=window.ue.getContent();$.post({url:t,data:{title:n,desc:r,content:a,thumbnail:i,category:s,pk:o},success:function(e){200===e.code?xfzalert.alertSuccess("添加新闻成功!",function(){window.location.reload()}):window.messageBox.showError(e.message)},error:function(e){window.messageBox.showError(e.message)}})})},News.prototype.listenUploadfileEvent=function(){$("#thumbnail-btn").change(function(){var e=this.files[0],o=new FormData;o.append("file",e),$.post({url:"/cms/upload_file/",data:o,contentType:!1,processData:!1,success:function(e){if(200===e.code){var o=e.data.url;$("#thumbnail-form").val(o)}else window.messageBox.showError(e.message)},error:function(e){console.log(e)}})})},News.prototype.listenQiniuFileUploadEvent=function(){var i=this;$("#thumbnail-btn").change(function(){var r=this.files[0];$.get({url:"/cms/qn_token/",success:function(e){if(200===e.code){var o=e.data.token,t=(new Date).getTime()+"."+r.name.split(".")[1],n={fname:t,params:{},mimeType:null},s={useCdnDomain:!0,retryCount:5,region:qiniu.region.z2};qiniu.upload(r,t,o,n,s).subscribe({next:i.handleFileUploadProcess,error:i.handleFileUploadError,complete:i.handleFileUploadComplete})}}})})},News.prototype.handleFileUploadProcess=function(e){var o=e.total.percent.toFixed(0)+"%";News.progressGroup.show();var t=$(".progress-bar");t.css({width:o}),t.text(o)},News.prototype.handleFileUploadError=function(e){window.messageBox.showError(e.message),$("#progress-group").hide(),console.log(e.message)},News.prototype.handleFileUploadComplete=function(e){console.log(e),$("#progress-group").hide();var o="http://ptmoolpfo.bkt.clouddn.com/"+e.key;$("#thumbnail-form").val(o)},$(function(){(new News).run(),News.progressGroup=$("#progress-group")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndyaXRlX25ld3MuanMiXSwibmFtZXMiOlsiTmV3cyIsInRoaXMiLCJwcm9ncmVzc0dyb3VwIiwiJCIsInByb3RvdHlwZSIsInJ1biIsInRoYXQiLCJsaXN0ZW5RaW5pdUZpbGVVcGxvYWRFdmVudCIsImluaXRVZWRpdG9yIiwibGlzdGVuQWRkTmV3c0V2ZW50Iiwid2luZG93IiwidWUiLCJVRSIsImdldEVkaXRvciIsImluaXRpYWxGcmFtZUhlaWdodCIsInNlcnZlclVybCIsImNsaWNrIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInBrIiwiYXR0ciIsInVybCIsInRpdGxlIiwidmFsIiwiY2F0ZWdvcnkiLCJkZXNjIiwidGh1bWJuYWlsIiwiY29udGVudCIsImdldENvbnRlbnQiLCJwb3N0IiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXMiLCJjb2RlIiwieGZ6YWxlcnQiLCJhbGVydFN1Y2Nlc3MiLCJsb2NhdGlvbiIsInJlbG9hZCIsIm1lc3NhZ2VCb3giLCJzaG93RXJyb3IiLCJtZXNzYWdlIiwiZXJyb3IiLCJsaXN0ZW5VcGxvYWRmaWxlRXZlbnQiLCJjaGFuZ2UiLCJmaWxlIiwiZmlsZXMiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiY29udGVudFR5cGUiLCJwcm9jZXNzRGF0YSIsImNvbnNvbGUiLCJsb2ciLCJnZXQiLCJ0b2tlbiIsImtleSIsIkRhdGUiLCJnZXRUaW1lIiwibmFtZSIsInNwbGl0IiwicHV0RXh0cmEiLCJmbmFtZSIsInBhcmFtcyIsIm1pbWVUeXBlIiwiY29uZmlnIiwidXNlQ2RuRG9tYWluIiwicmV0cnlDb3VudCIsInJlZ2lvbiIsInFpbml1IiwiejIiLCJ1cGxvYWQiLCJzdWJzY3JpYmUiLCJuZXh0IiwiaGFuZGxlRmlsZVVwbG9hZFByb2Nlc3MiLCJoYW5kbGVGaWxlVXBsb2FkRXJyb3IiLCJjb21wbGV0ZSIsImhhbmRsZUZpbGVVcGxvYWRDb21wbGV0ZSIsInJlc3BvbnNlIiwicGVyY2VudFRleHQiLCJ0b3RhbCIsInBlcmNlbnQiLCJ0b0ZpeGVkIiwic2hvdyIsInByb2dyZXNzQmFyIiwiY3NzIiwid2lkdGgiLCJ0ZXh0IiwiaGlkZSJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsT0FDTEMsS0FBS0MsY0FBZ0JDLEVBQUUsbUJBRzNCSCxLQUFLSSxVQUFVQyxJQUFNLFdBQ2pCLElBQUlDLEVBQU1MLEtBRVZLLEVBQUtDLDZCQUNMRCxFQUFLRSxjQUNMRixFQUFLRyxzQkFHVFQsS0FBS0ksVUFBVUksWUFBYyxXQUN6QkUsT0FBT0MsR0FBS0MsR0FBR0MsVUFBVSxZQUFhLENBQ2xDQyxtQkFBc0IsSUFDdEJDLFVBQWEsc0JBSXJCZixLQUFLSSxVQUFVSyxtQkFBcUIsV0FFbEJOLEVBQUUsZUFDUmEsTUFBTSxTQUFVQyxHQUN0QkEsRUFBTUMsaUJBRU4sSUFDSUMsRUFETWhCLEVBQUVGLE1BQ0NtQixLQUFLLGdCQUNkQyxFQUFNLEdBR05BLEVBREFGLEVBQ00sa0JBRUEsbUJBR1YsSUFBSUcsRUFBUW5CLEVBQUUsdUJBQXVCb0IsTUFDakNDLEVBQVdyQixFQUFFLDJCQUEyQm9CLE1BQ3hDRSxFQUFPdEIsRUFBRSxzQkFBc0JvQixNQUMvQkcsRUFBWXZCLEVBQUUsMkJBQTJCb0IsTUFDekNJLEVBQVVqQixPQUFPQyxHQUFHaUIsYUFFeEJ6QixFQUFFMEIsS0FBSyxDQUNIUixJQUFLQSxFQUNMUyxLQUFNLENBQ0ZSLE1BQVNBLEVBQ1RHLEtBQVFBLEVBQ1JFLFFBQVdBLEVBQ1hELFVBQWFBLEVBQ2JGLFNBQVlBLEVBQ1pMLEdBQU1BLEdBRVZZLFFBQVMsU0FBVUMsR0FDRSxNQUFiQSxFQUFJQyxLQUNKQyxTQUFTQyxhQUFhLFVBQVcsV0FDN0J6QixPQUFPMEIsU0FBU0MsV0FHcEIzQixPQUFPNEIsV0FBV0MsVUFBVVAsRUFBSVEsVUFHeENDLE1BQU8sU0FBVVQsR0FDYnRCLE9BQU80QixXQUFXQyxVQUFVUCxFQUFJUSxlQU05Q3hDLEtBQUtJLFVBQVVzQyxzQkFBd0IsV0FDcEJ2QyxFQUFFLGtCQUNSd0MsT0FBTyxXQUVaLElBQUlDLEVBQU8zQyxLQUFLNEMsTUFBTSxHQUNsQkMsRUFBVyxJQUFJQyxTQUNuQkQsRUFBU0UsT0FBTyxPQUFRSixHQUV4QnpDLEVBQUUwQixLQUFLLENBQ0hSLElBQUssb0JBQ0xTLEtBQU1nQixFQUNORyxhQUFhLEVBQ2JDLGFBQWEsRUFDYm5CLFFBQVMsU0FBVUMsR0FDZixHQUFpQixNQUFiQSxFQUFJQyxLQUFjLENBQ2xCLElBQUlaLEVBQU1XLEVBQVUsS0FBTyxJQUNON0IsRUFBRSxtQkFDUm9CLElBQUlGLFFBRW5CWCxPQUFPNEIsV0FBV0MsVUFBVVAsRUFBSVEsVUFHeENDLE1BQU8sU0FBVVQsR0FDYm1CLFFBQVFDLElBQUlwQixTQU01QmhDLEtBQUtJLFVBQVVHLDJCQUE2QixXQUMxQyxJQUFJRCxFQUFPTCxLQUNRRSxFQUFFLGtCQUVSd0MsT0FBTyxXQUNoQixJQUFJQyxFQUFPM0MsS0FBSzRDLE1BQU0sR0FDdEIxQyxFQUFFa0QsSUFBSSxDQUNGaEMsSUFBSyxpQkFDTFUsUUFBUyxTQUFVQyxHQUNmLEdBQWlCLE1BQWJBLEVBQUlDLEtBQWMsQ0FDbEIsSUFBSXFCLEVBQVF0QixFQUFVLEtBQVMsTUFFM0J1QixHQUFNLElBQUtDLE1BQVFDLFVBQVksSUFBTWIsRUFBS2MsS0FBS0MsTUFBTSxLQUFLLEdBQzFEQyxFQUFXLENBQ1hDLE1BQU9OLEVBQ1BPLE9BQVEsR0FFUkMsU0FBVSxNQUVWQyxFQUFTLENBQ1RDLGNBQWMsRUFDZEMsV0FBWSxFQUNaQyxPQUFRQyxNQUFNRCxPQUFPRSxJQUVSRCxNQUFNRSxPQUFPMUIsRUFBTVcsRUFBS0QsRUFBT00sRUFBVUksR0FDL0NPLFVBQVUsQ0FDakJDLEtBQVFsRSxFQUFLbUUsd0JBQ2JoQyxNQUFTbkMsRUFBS29FLHNCQUNkQyxTQUFZckUsRUFBS3NFLGtDQVN2QzVFLEtBQUtJLFVBQVVxRSx3QkFBMEIsU0FBVUksR0FDL0MsSUFFSUMsRUFGUUQsRUFBU0UsTUFDREMsUUFDTUMsUUFBUSxHQUFLLElBQ25CakYsS0FBS0UsY0FDWGdGLE9BRWQsSUFBSUMsRUFBY2hGLEVBQUUsaUJBQ3BCZ0YsRUFBWUMsSUFBSSxDQUFDQyxNQUFTUCxJQUMxQkssRUFBWUcsS0FBS1IsSUFJckI5RSxLQUFLSSxVQUFVc0Usc0JBQXdCLFNBQVVHLEdBQzdDbkUsT0FBTzRCLFdBQVdDLFVBQVVzQyxFQUFTckMsU0FDakJyQyxFQUFFLG1CQUNSb0YsT0FDZHBDLFFBQVFDLElBQUl5QixFQUFTckMsVUFHekJ4QyxLQUFLSSxVQUFVd0UseUJBQTJCLFNBQVVDLEdBQ2hEMUIsUUFBUUMsSUFBSXlCLEdBQ1ExRSxFQUFFLG1CQUNSb0YsT0FFZCxJQUVJbEUsRUFGYyxvQ0FDSHdELEVBQVN0QixJQUVIcEQsRUFBRSxtQkFDUm9CLElBQUlGLElBR3ZCbEIsRUFBRSxZQUNhLElBQUlILE1BQ1ZLLE1BQ0xMLEtBQUtFLGNBQWdCQyxFQUFFIiwiZmlsZSI6IndyaXRlX25ld3MubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gTmV3cygpIHtcbiAgICB0aGlzLnByb2dyZXNzR3JvdXAgPSAkKCcjcHJvZ3Jlc3MtZ3JvdXAnKTtcbn1cblxuTmV3cy5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID10aGlzO1xuICAgIC8vIHRoYXQubGlzdGVuVXBsb2FkZmlsZUV2ZW50KCk7XG4gICAgdGhhdC5saXN0ZW5RaW5pdUZpbGVVcGxvYWRFdmVudCgpO1xuICAgIHRoYXQuaW5pdFVlZGl0b3IoKTtcbiAgICB0aGF0Lmxpc3RlbkFkZE5ld3NFdmVudCgpO1xufTtcblxuTmV3cy5wcm90b3R5cGUuaW5pdFVlZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LnVlID0gVUUuZ2V0RWRpdG9yKCdjb250YWluZXInLCB7XG4gICAgICAgICdpbml0aWFsRnJhbWVIZWlnaHQnOiA1MDAsXG4gICAgICAgICdzZXJ2ZXJVcmwnOiAnL3VlZGl0b3IvdXBsb2FkLydcbiAgICB9KTtcbn07XG5cbk5ld3MucHJvdG90eXBlLmxpc3RlbkFkZE5ld3NFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIgc3VibWl0QnRuID0gJCgnI3N1Ym1pdC1idG4nKTtcbiAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgdmFyIGJ0biA9ICQodGhpcyk7XG4gICAgICB2YXIgcGsgPSBidG4uYXR0cignZGF0YS1uZXdzLWlkJyk7XG4gICAgICB2YXIgdXJsID0gJyc7XG5cbiAgICAgIGlmIChwaykge1xuICAgICAgICAgIHVybCA9ICcvY21zL2VkaXRfbmV3cy8nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1cmwgPSAnL2Ntcy93cml0ZV9uZXdzLyc7XG4gICAgICB9XG5cbiAgICAgIHZhciB0aXRsZSA9ICQoXCJpbnB1dFtuYW1lPSd0aXRsZSddXCIpLnZhbCgpO1xuICAgICAgdmFyIGNhdGVnb3J5ID0gJChcInNlbGVjdFtuYW1lPSdjYXRlZ29yeSddXCIpLnZhbCgpO1xuICAgICAgdmFyIGRlc2MgPSAkKFwiaW5wdXRbbmFtZT0nZGVzYyddXCIpLnZhbCgpO1xuICAgICAgdmFyIHRodW1ibmFpbCA9ICQoXCJpbnB1dFtuYW1lPSd0aHVtYm5haWwnXVwiKS52YWwoKTtcbiAgICAgIHZhciBjb250ZW50ID0gd2luZG93LnVlLmdldENvbnRlbnQoKTtcblxuICAgICAgJC5wb3N0KHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICd0aXRsZSc6IHRpdGxlLFxuICAgICAgICAgICAgICAnZGVzYyc6IGRlc2MsXG4gICAgICAgICAgICAgICdjb250ZW50JzogY29udGVudCxcbiAgICAgICAgICAgICAgJ3RodW1ibmFpbCc6IHRodW1ibmFpbCxcbiAgICAgICAgICAgICAgJ2NhdGVnb3J5JzogY2F0ZWdvcnksXG4gICAgICAgICAgICAgICdwayc6IHBrXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICB4ZnphbGVydC5hbGVydFN1Y2Nlc3MoJ+a3u+WKoOaWsOmXu+aIkOWKnyEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihyZXMubWVzc2FnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihyZXMubWVzc2FnZSk7XG4gICAgICAgICAgfVxuICAgICAgfSlcbiAgfSlcbn07XG5cbk5ld3MucHJvdG90eXBlLmxpc3RlblVwbG9hZGZpbGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGh1bWJCdG4gPSAkKCcjdGh1bWJuYWlsLWJ0bicpO1xuICAgIHRodW1iQnRuLmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIOi/memHjOWPr+S7peS4iuS8oOWkmuS4quWbvueJh++8jOeUqGZpbGVbMF3pgInkuK3nrKzkuIDkuKo7XG4gICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcbiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUpO1xuXG4gICAgICAgICQucG9zdCh7XG4gICAgICAgICAgICB1cmw6ICcvY21zL3VwbG9hZF9maWxlLycsXG4gICAgICAgICAgICBkYXRhOiBmb3JtRGF0YSxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcbiAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcmVzWydkYXRhJ11bJ3VybCddO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGh1bWJuYWlsSW5wdXQgPSAkKCcjdGh1bWJuYWlsLWZvcm0nKTtcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsSW5wdXQudmFsKHVybCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKHJlcy5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSk7XG59O1xuXG5OZXdzLnByb3RvdHlwZS5saXN0ZW5RaW5pdUZpbGVVcGxvYWRFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIgdGh1bWJuYWlsQnRuID0gJCgnI3RodW1ibmFpbC1idG4nKTtcblxuICB0aHVtYm5haWxCdG4uY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcbiAgICAgICQuZ2V0KHtcbiAgICAgICAgICB1cmw6ICcvY21zL3FuX3Rva2VuLycsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgdmFyIHRva2VuID0gcmVzWydkYXRhJ11bJ3Rva2VuJ107XG4gICAgICAgICAgICAgICAgICAvLyDpgJrov4fml7bpl7TmiLMgKyDmlofku7blkI7nvIDlkI3nmoTmlrnlvI/nlJ/miJAga2V5XG4gICAgICAgICAgICAgICAgICB2YXIga2V5ID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKSArICcuJyArIGZpbGUubmFtZS5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgICAgICAgdmFyIHB1dEV4dHJhID0ge1xuICAgICAgICAgICAgICAgICAgICAgIGZuYW1lOiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAvLyBtaW1lVHlwZTogWydpbWFnZS9wbmcnLCAnaW1hZ2UvanBlZycsICdpbWFnZS9naWYnLCAndmlkZW8veC1tcy13bXYnLCAndmlkZW8vZmx2J11cbiAgICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZTogbnVsbFxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgdXNlQ2RuRG9tYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgIHJldHJ5Q291bnQ6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgcmVnaW9uOiBxaW5pdS5yZWdpb24uejJcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IHFpbml1LnVwbG9hZChmaWxlLCBrZXksIHRva2VuLCBwdXRFeHRyYSwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmFibGUuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICAgICAgICAnbmV4dCc6IHRoYXQuaGFuZGxlRmlsZVVwbG9hZFByb2Nlc3MsXG4gICAgICAgICAgICAgICAgICAgICAgJ2Vycm9yJzogdGhhdC5oYW5kbGVGaWxlVXBsb2FkRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgJ2NvbXBsZXRlJzogdGhhdC5oYW5kbGVGaWxlVXBsb2FkQ29tcGxldGVcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgIH0pXG4gIH0pXG59O1xuXG5OZXdzLnByb3RvdHlwZS5oYW5kbGVGaWxlVXBsb2FkUHJvY2VzcyA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIHZhciB0b3RhbCA9IHJlc3BvbnNlLnRvdGFsO1xuICAgIHZhciBwZXJjZW50ID0gdG90YWwucGVyY2VudDtcbiAgICB2YXIgcGVyY2VudFRleHQgPSBwZXJjZW50LnRvRml4ZWQoMCkgKyAnJSc7XG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSBOZXdzLnByb2dyZXNzR3JvdXA7XG4gICAgcHJvZ3Jlc3NHcm91cC5zaG93KCk7XG5cbiAgICB2YXIgcHJvZ3Jlc3NCYXIgPSAkKCcucHJvZ3Jlc3MtYmFyJyk7XG4gICAgcHJvZ3Jlc3NCYXIuY3NzKHsnd2lkdGgnOiBwZXJjZW50VGV4dH0pO1xuICAgIHByb2dyZXNzQmFyLnRleHQocGVyY2VudFRleHQpO1xuXG59O1xuXG5OZXdzLnByb3RvdHlwZS5oYW5kbGVGaWxlVXBsb2FkRXJyb3IgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IocmVzcG9uc2UubWVzc2FnZSk7XG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSAkKCcjcHJvZ3Jlc3MtZ3JvdXAnKTtcbiAgICBwcm9ncmVzc0dyb3VwLmhpZGUoKTtcbiAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5tZXNzYWdlKTtcbn07XG5cbk5ld3MucHJvdG90eXBlLmhhbmRsZUZpbGVVcGxvYWRDb21wbGV0ZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICB2YXIgcHJvZ3Jlc3NHcm91cCA9ICQoJyNwcm9ncmVzcy1ncm91cCcpO1xuICAgIHByb2dyZXNzR3JvdXAuaGlkZSgpO1xuXG4gICAgdmFyIHFpbml1RG9tYWluID0gJ2h0dHA6Ly9wdG1vb2xwZm8uYmt0LmNsb3VkZG4uY29tLyc7XG4gICAgdmFyIGZpbGVOYW1lID0gcmVzcG9uc2Uua2V5O1xuICAgIHZhciB1cmwgPSBxaW5pdURvbWFpbiArIGZpbGVOYW1lO1xuICAgIHZhciB0aHVtYm5haWxJbnB1dCA9ICQoJyN0aHVtYm5haWwtZm9ybScpO1xuICAgIHRodW1ibmFpbElucHV0LnZhbCh1cmwpO1xufTtcblxuJChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG5ld3MgPSBuZXcgTmV3cygpO1xuICAgIG5ld3MucnVuKCk7XG4gICAgTmV3cy5wcm9ncmVzc0dyb3VwID0gJCgnI3Byb2dyZXNzLWdyb3VwJyk7XG59KTsiXX0=
