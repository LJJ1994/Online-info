function AddTeacher(){this.progressGroup=$("#progress-group")}AddTeacher.prototype.run=function(){var e=this;e.listenQiniuFileUploadEvent(),e.initUeditor(),e.listenAddNewsEvent(),e.listenDeleteTeacherEvent()},AddTeacher.prototype.initUeditor=function(){window.ue=UE.getEditor("profile-editor",{initialFrameHeight:500,serverUrl:"/ueditor/upload/"})},AddTeacher.prototype.listenAddNewsEvent=function(){$("#teacher-submit-btn").click(function(e){e.preventDefault();var o=$(this).attr("data-teacher-id");console.log("pk的值:",o);var t="";t=o?"/cms/edit_course_teacher/":"/cms/add_course_teacher/";var r=$("input[name='username']").val(),n=$("input[name='jobtitle']").val(),a=$("input[name='thumbnail']").val(),i=window.ue.getContent();console.log(r,n,a,i),$.post({url:t,data:{username:r,jobtitle:n,avatar_url:a,profile:i,pk:o},success:function(e){200===e.code?xfzalert.alertSuccess("添加讲师成功!",function(){window.location.reload()}):window.messageBox.showError(e.message)},error:function(e){window.messageBox.showError(e.message)}})})},AddTeacher.prototype.listenDeleteTeacherEvent=function(){$(".delete-btn").click(function(e){e.preventDefault();var o=$(this).attr("data-teacher-id");xfzalert.alertConfirm({text:"你确实要删除该讲师?",confirmCallback:function(){$.post({url:"/cms/delete_course_teacher/",data:{teacher_id:o},success:function(e){200===e.code&&(window.location.reload(),window.messageBox.showSuccess(message=e.message))}})}})})},AddTeacher.prototype.listenUploadfileEvent=function(){$("#thumbnail-btn").change(function(){var e=this.files[0],o=new FormData;o.append("file",e),$.post({url:"/cms/upload_file/",data:o,contentType:!1,processData:!1,success:function(e){if(200===e.code){var o=e.data.url;$("#thumbnail-form").val(o)}else window.messageBox.showError(e.message)},error:function(e){console.log(e)}})})},AddTeacher.prototype.listenQiniuFileUploadEvent=function(){var i=this;$("#thumbnail-btn").change(function(){var a=this.files[0];$.get({url:"/cms/qn_token/",success:function(e){if(200===e.code){var o=e.data.token,t=(new Date).getTime()+"."+a.name.split(".")[1],r={fname:t,params:{},mimeType:null},n={useCdnDomain:!0,retryCount:5,region:qiniu.region.z2};qiniu.upload(a,t,o,r,n).subscribe({next:i.handleFileUploadProcess,error:i.handleFileUploadError,complete:i.handleFileUploadComplete})}}})})},AddTeacher.prototype.handleFileUploadProcess=function(e){var o=e.total.percent.toFixed(0)+"%";AddTeacher.progressGroup.show();var t=$(".progress-bar");t.css({width:o}),t.text(o)},AddTeacher.prototype.handleFileUploadError=function(e){window.messageBox.showError(e.message),$("#progress-group").hide(),console.log(e.message)},AddTeacher.prototype.handleFileUploadComplete=function(e){console.log(e),$("#progress-group").hide();var o="http://ptmoolpfo.bkt.clouddn.com/"+e.key;$("#thumbnail-form").val(o)},$(function(){(new AddTeacher).run(),AddTeacher.progressGroup=$("#progress-group")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1Yl90ZWFjaGVyLmpzIl0sIm5hbWVzIjpbIkFkZFRlYWNoZXIiLCJ0aGlzIiwicHJvZ3Jlc3NHcm91cCIsIiQiLCJwcm90b3R5cGUiLCJydW4iLCJ0aGF0IiwibGlzdGVuUWluaXVGaWxlVXBsb2FkRXZlbnQiLCJpbml0VWVkaXRvciIsImxpc3RlbkFkZE5ld3NFdmVudCIsImxpc3RlbkRlbGV0ZVRlYWNoZXJFdmVudCIsIndpbmRvdyIsInVlIiwiVUUiLCJnZXRFZGl0b3IiLCJpbml0aWFsRnJhbWVIZWlnaHQiLCJzZXJ2ZXJVcmwiLCJjbGljayIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJwayIsImF0dHIiLCJjb25zb2xlIiwibG9nIiwidXJsIiwidXNlcm5hbWUiLCJ2YWwiLCJqb2J0aXRsZSIsImF2YXRhcl91cmwiLCJwcm9maWxlIiwiZ2V0Q29udGVudCIsInBvc3QiLCJkYXRhIiwic3VjY2VzcyIsInJlcyIsImNvZGUiLCJ4ZnphbGVydCIsImFsZXJ0U3VjY2VzcyIsImxvY2F0aW9uIiwicmVsb2FkIiwibWVzc2FnZUJveCIsInNob3dFcnJvciIsIm1lc3NhZ2UiLCJlcnJvciIsInRlYWNoZXJfaWQiLCJhbGVydENvbmZpcm0iLCJ0ZXh0IiwiY29uZmlybUNhbGxiYWNrIiwic2hvd1N1Y2Nlc3MiLCJsaXN0ZW5VcGxvYWRmaWxlRXZlbnQiLCJjaGFuZ2UiLCJmaWxlIiwiZmlsZXMiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiY29udGVudFR5cGUiLCJwcm9jZXNzRGF0YSIsImdldCIsInRva2VuIiwia2V5IiwiRGF0ZSIsImdldFRpbWUiLCJuYW1lIiwic3BsaXQiLCJwdXRFeHRyYSIsImZuYW1lIiwicGFyYW1zIiwibWltZVR5cGUiLCJjb25maWciLCJ1c2VDZG5Eb21haW4iLCJyZXRyeUNvdW50IiwicmVnaW9uIiwicWluaXUiLCJ6MiIsInVwbG9hZCIsInN1YnNjcmliZSIsIm5leHQiLCJoYW5kbGVGaWxlVXBsb2FkUHJvY2VzcyIsImhhbmRsZUZpbGVVcGxvYWRFcnJvciIsImNvbXBsZXRlIiwiaGFuZGxlRmlsZVVwbG9hZENvbXBsZXRlIiwicmVzcG9uc2UiLCJwZXJjZW50VGV4dCIsInRvdGFsIiwicGVyY2VudCIsInRvRml4ZWQiLCJzaG93IiwicHJvZ3Jlc3NCYXIiLCJjc3MiLCJ3aWR0aCIsImhpZGUiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLGFBQ0xDLEtBQUtDLGNBQWdCQyxFQUFFLG1CQUczQkgsV0FBV0ksVUFBVUMsSUFBTSxXQUN2QixJQUFJQyxFQUFNTCxLQUVWSyxFQUFLQyw2QkFDTEQsRUFBS0UsY0FDTEYsRUFBS0cscUJBQ0xILEVBQUtJLDRCQUdUVixXQUFXSSxVQUFVSSxZQUFjLFdBQy9CRyxPQUFPQyxHQUFLQyxHQUFHQyxVQUFVLGlCQUFrQixDQUN2Q0MsbUJBQXNCLElBQ3RCQyxVQUFhLHNCQUlyQmhCLFdBQVdJLFVBQVVLLG1CQUFxQixXQUV4Qk4sRUFBRSx1QkFDUmMsTUFBTSxTQUFVQyxHQUN0QkEsRUFBTUMsaUJBRU4sSUFDSUMsRUFETWpCLEVBQUVGLE1BQ0NvQixLQUFLLG1CQUNsQkMsUUFBUUMsSUFBSSxRQUFTSCxHQUNyQixJQUFJSSxFQUFNLEdBR05BLEVBREFKLEVBQ00sNEJBRUEsMkJBR1YsSUFBSUssRUFBV3RCLEVBQUUsMEJBQTBCdUIsTUFDdkNDLEVBQVd4QixFQUFFLDBCQUEwQnVCLE1BQ3ZDRSxFQUFhekIsRUFBRSwyQkFBMkJ1QixNQUMxQ0csRUFBVWxCLE9BQU9DLEdBQUdrQixhQUN4QlIsUUFBUUMsSUFBSUUsRUFBVUUsRUFBVUMsRUFBWUMsR0FFNUMxQixFQUFFNEIsS0FBSyxDQUNIUCxJQUFLQSxFQUNMUSxLQUFNLENBQ0ZQLFNBQVlBLEVBQ1pFLFNBQVlBLEVBQ1pDLFdBQWNBLEVBQ2RDLFFBQVdBLEVBQ1hULEdBQU1BLEdBRVZhLFFBQVMsU0FBVUMsR0FDRSxNQUFiQSxFQUFJQyxLQUNKQyxTQUFTQyxhQUFhLFVBQVcsV0FDN0IxQixPQUFPMkIsU0FBU0MsV0FHcEI1QixPQUFPNkIsV0FBV0MsVUFBVVAsRUFBSVEsVUFHeENDLE1BQU8sU0FBVVQsR0FDYnZCLE9BQU82QixXQUFXQyxVQUFVUCxFQUFJUSxlQU05QzFDLFdBQVdJLFVBQVVNLHlCQUEyQixXQUVwQ1AsRUFBRSxlQUNSYyxNQUFNLFNBQVVDLEdBQ2xCQSxFQUFNQyxpQkFDTixJQUNJeUIsRUFEYXpDLEVBQUVGLE1BQ1NvQixLQUFLLG1CQUVqQ2UsU0FBU1MsYUFBYSxDQUNwQkMsS0FBUSxhQUNSQyxnQkFBbUIsV0FDakI1QyxFQUFFNEIsS0FBSyxDQUNMUCxJQUFLLDhCQUNMUSxLQUFNLENBQ0pZLFdBQWNBLEdBRWhCWCxRQUFTLFNBQVVDLEdBQ0EsTUFBYkEsRUFBSUMsT0FDTnhCLE9BQU8yQixTQUFTQyxTQUNoQjVCLE9BQU82QixXQUFXUSxZQUFZTixRQUFRUixFQUFJUSxtQkFTeEQxQyxXQUFXSSxVQUFVNkMsc0JBQXdCLFdBQzFCOUMsRUFBRSxrQkFDUitDLE9BQU8sV0FFWixJQUFJQyxFQUFPbEQsS0FBS21ELE1BQU0sR0FDbEJDLEVBQVcsSUFBSUMsU0FDbkJELEVBQVNFLE9BQU8sT0FBUUosR0FFeEJoRCxFQUFFNEIsS0FBSyxDQUNIUCxJQUFLLG9CQUNMUSxLQUFNcUIsRUFDTkcsYUFBYSxFQUNiQyxhQUFhLEVBQ2J4QixRQUFTLFNBQVVDLEdBQ2YsR0FBaUIsTUFBYkEsRUFBSUMsS0FBYyxDQUNsQixJQUFJWCxFQUFNVSxFQUFVLEtBQU8sSUFDTi9CLEVBQUUsbUJBQ1J1QixJQUFJRixRQUVuQmIsT0FBTzZCLFdBQVdDLFVBQVVQLEVBQUlRLFVBR3hDQyxNQUFPLFNBQVVULEdBQ2JaLFFBQVFDLElBQUlXLFNBTTVCbEMsV0FBV0ksVUFBVUcsMkJBQTZCLFdBQ2hELElBQUlELEVBQU9MLEtBQ1FFLEVBQUUsa0JBRVIrQyxPQUFPLFdBQ2hCLElBQUlDLEVBQU9sRCxLQUFLbUQsTUFBTSxHQUN0QmpELEVBQUV1RCxJQUFJLENBQ0ZsQyxJQUFLLGlCQUNMUyxRQUFTLFNBQVVDLEdBQ2YsR0FBaUIsTUFBYkEsRUFBSUMsS0FBYyxDQUNsQixJQUFJd0IsRUFBUXpCLEVBQVUsS0FBUyxNQUUzQjBCLEdBQU0sSUFBS0MsTUFBUUMsVUFBWSxJQUFNWCxFQUFLWSxLQUFLQyxNQUFNLEtBQUssR0FDMURDLEVBQVcsQ0FDWEMsTUFBT04sRUFDUE8sT0FBUSxHQUVSQyxTQUFVLE1BRVZDLEVBQVMsQ0FDVEMsY0FBYyxFQUNkQyxXQUFZLEVBQ1pDLE9BQVFDLE1BQU1ELE9BQU9FLElBRVJELE1BQU1FLE9BQU94QixFQUFNUyxFQUFLRCxFQUFPTSxFQUFVSSxHQUMvQ08sVUFBVSxDQUNqQkMsS0FBUXZFLEVBQUt3RSx3QkFDYm5DLE1BQVNyQyxFQUFLeUUsc0JBQ2RDLFNBQVkxRSxFQUFLMkUsa0NBU3ZDakYsV0FBV0ksVUFBVTBFLHdCQUEwQixTQUFVSSxHQUNyRCxJQUVJQyxFQUZRRCxFQUFTRSxNQUNEQyxRQUNNQyxRQUFRLEdBQUssSUFDbkJ0RixXQUFXRSxjQUNqQnFGLE9BRWQsSUFBSUMsRUFBY3JGLEVBQUUsaUJBQ3BCcUYsRUFBWUMsSUFBSSxDQUFDQyxNQUFTUCxJQUMxQkssRUFBWTFDLEtBQUtxQyxJQUlyQm5GLFdBQVdJLFVBQVUyRSxzQkFBd0IsU0FBVUcsR0FDbkR2RSxPQUFPNkIsV0FBV0MsVUFBVXlDLEVBQVN4QyxTQUNqQnZDLEVBQUUsbUJBQ1J3RixPQUNkckUsUUFBUUMsSUFBSTJELEVBQVN4QyxVQUd6QjFDLFdBQVdJLFVBQVU2RSx5QkFBMkIsU0FBVUMsR0FDdEQ1RCxRQUFRQyxJQUFJMkQsR0FDUS9FLEVBQUUsbUJBQ1J3RixPQUVkLElBRUluRSxFQUZjLG9DQUNIMEQsRUFBU3RCLElBRUh6RCxFQUFFLG1CQUNSdUIsSUFBSUYsSUFHdkJyQixFQUFFLFlBQ21CLElBQUlILFlBQ1ZLLE1BQ1hMLFdBQVdFLGNBQWdCQyxFQUFFIiwiZmlsZSI6InB1Yl90ZWFjaGVyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEFkZFRlYWNoZXIoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0dyb3VwID0gJCgnI3Byb2dyZXNzLWdyb3VwJyk7XG59XG5cbkFkZFRlYWNoZXIucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9dGhpcztcbiAgICAvLyB0aGF0Lmxpc3RlblVwbG9hZGZpbGVFdmVudCgpO1xuICAgIHRoYXQubGlzdGVuUWluaXVGaWxlVXBsb2FkRXZlbnQoKTtcbiAgICB0aGF0LmluaXRVZWRpdG9yKCk7XG4gICAgdGhhdC5saXN0ZW5BZGROZXdzRXZlbnQoKTtcbiAgICB0aGF0Lmxpc3RlbkRlbGV0ZVRlYWNoZXJFdmVudCgpO1xufTtcblxuQWRkVGVhY2hlci5wcm90b3R5cGUuaW5pdFVlZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LnVlID0gVUUuZ2V0RWRpdG9yKCdwcm9maWxlLWVkaXRvcicsIHtcbiAgICAgICAgJ2luaXRpYWxGcmFtZUhlaWdodCc6IDUwMCxcbiAgICAgICAgJ3NlcnZlclVybCc6ICcvdWVkaXRvci91cGxvYWQvJ1xuICAgIH0pO1xufTtcblxuQWRkVGVhY2hlci5wcm90b3R5cGUubGlzdGVuQWRkTmV3c0V2ZW50ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHZhciBzdWJtaXRCdG4gPSAkKCcjdGVhY2hlci1zdWJtaXQtYnRuJyk7XG4gIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIHZhciBidG4gPSAkKHRoaXMpO1xuICAgICAgdmFyIHBrID0gYnRuLmF0dHIoJ2RhdGEtdGVhY2hlci1pZCcpO1xuICAgICAgY29uc29sZS5sb2coJ3Br55qE5YC8OicsIHBrKTtcbiAgICAgIHZhciB1cmwgPSAnJztcblxuICAgICAgaWYgKHBrKSB7XG4gICAgICAgICAgdXJsID0gJy9jbXMvZWRpdF9jb3Vyc2VfdGVhY2hlci8nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1cmwgPSAnL2Ntcy9hZGRfY291cnNlX3RlYWNoZXIvJztcbiAgICAgIH1cblxuICAgICAgdmFyIHVzZXJuYW1lID0gJChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIikudmFsKCk7XG4gICAgICB2YXIgam9idGl0bGUgPSAkKFwiaW5wdXRbbmFtZT0nam9idGl0bGUnXVwiKS52YWwoKTtcbiAgICAgIHZhciBhdmF0YXJfdXJsID0gJChcImlucHV0W25hbWU9J3RodW1ibmFpbCddXCIpLnZhbCgpO1xuICAgICAgdmFyIHByb2ZpbGUgPSB3aW5kb3cudWUuZ2V0Q29udGVudCgpO1xuICAgICAgY29uc29sZS5sb2codXNlcm5hbWUsIGpvYnRpdGxlLCBhdmF0YXJfdXJsLCBwcm9maWxlKTtcblxuICAgICAgJC5wb3N0KHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxuICAgICAgICAgICAgICAnam9idGl0bGUnOiBqb2J0aXRsZSxcbiAgICAgICAgICAgICAgJ2F2YXRhcl91cmwnOiBhdmF0YXJfdXJsLFxuICAgICAgICAgICAgICAncHJvZmlsZSc6IHByb2ZpbGUsXG4gICAgICAgICAgICAgICdwayc6IHBrXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICB4ZnphbGVydC5hbGVydFN1Y2Nlc3MoJ+a3u+WKoOiusuW4iOaIkOWKnyEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihyZXMubWVzc2FnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihyZXMubWVzc2FnZSk7XG4gICAgICAgICAgfVxuICAgICAgfSlcbiAgfSlcbn07XG5cbkFkZFRlYWNoZXIucHJvdG90eXBlLmxpc3RlbkRlbGV0ZVRlYWNoZXJFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIgYnRuID0gJCgnLmRlbGV0ZS1idG4nKTtcbiAgYnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdmFyIGN1cnJlbnRCdG4gPSAkKHRoaXMpO1xuICAgIHZhciB0ZWFjaGVyX2lkID0gY3VycmVudEJ0bi5hdHRyKCdkYXRhLXRlYWNoZXItaWQnKTtcblxuICAgIHhmemFsZXJ0LmFsZXJ0Q29uZmlybSh7XG4gICAgICAndGV4dCc6ICfkvaDnoa7lrp7opoHliKDpmaTor6XorrLluIg/JyxcbiAgICAgICdjb25maXJtQ2FsbGJhY2snOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQucG9zdCh7XG4gICAgICAgICAgdXJsOiAnL2Ntcy9kZWxldGVfY291cnNlX3RlYWNoZXIvJyxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAndGVhY2hlcl9pZCc6IHRlYWNoZXJfaWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MobWVzc2FnZT1yZXMubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH0pXG59O1xuXG5BZGRUZWFjaGVyLnByb3RvdHlwZS5saXN0ZW5VcGxvYWRmaWxlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRodW1iQnRuID0gJCgnI3RodW1ibmFpbC1idG4nKTtcbiAgICB0aHVtYkJ0bi5jaGFuZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyDov5nph4zlj6/ku6XkuIrkvKDlpJrkuKrlm77niYfvvIznlKhmaWxlWzBd6YCJ5Lit56ys5LiA5LiqO1xuICAgICAgICB2YXIgZmlsZSA9IHRoaXMuZmlsZXNbMF07XG4gICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBmaWxlKTtcblxuICAgICAgICAkLnBvc3Qoe1xuICAgICAgICAgICAgdXJsOiAnL2Ntcy91cGxvYWRfZmlsZS8nLFxuICAgICAgICAgICAgZGF0YTogZm9ybURhdGEsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsXG4gICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHJlc1snZGF0YSddWyd1cmwnXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRodW1ibmFpbElucHV0ID0gJCgnI3RodW1ibmFpbC1mb3JtJyk7XG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbElucHV0LnZhbCh1cmwpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihyZXMubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xufTtcblxuQWRkVGVhY2hlci5wcm90b3R5cGUubGlzdGVuUWluaXVGaWxlVXBsb2FkRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0aGF0ID0gdGhpcztcbiAgdmFyIHRodW1ibmFpbEJ0biA9ICQoJyN0aHVtYm5haWwtYnRuJyk7XG5cbiAgdGh1bWJuYWlsQnRuLmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZmlsZSA9IHRoaXMuZmlsZXNbMF07XG4gICAgICAkLmdldCh7XG4gICAgICAgICAgdXJsOiAnL2Ntcy9xbl90b2tlbi8nLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlc1snZGF0YSddWyd0b2tlbiddO1xuICAgICAgICAgICAgICAgICAgLy8g6YCa6L+H5pe26Ze05oizICsg5paH5Lu25ZCO57yA5ZCN55qE5pa55byP55Sf5oiQIGtleVxuICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgKyAnLicgKyBmaWxlLm5hbWUuc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgICAgICAgIHZhciBwdXRFeHRyYSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICBmbmFtZToga2V5LFxuICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczoge30sXG4gICAgICAgICAgICAgICAgICAgICAgLy8gbWltZVR5cGU6IFsnaW1hZ2UvcG5nJywgJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvZ2lmJywgJ3ZpZGVvL3gtbXMtd212JywgJ3ZpZGVvL2ZsdiddXG4gICAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IG51bGxcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgICAgIHVzZUNkbkRvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICByZXRyeUNvdW50OiA1LFxuICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcWluaXUucmVnaW9uLnoyXG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSBxaW5pdS51cGxvYWQoZmlsZSwga2V5LCB0b2tlbiwgcHV0RXh0cmEsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgICAgICAgJ25leHQnOiB0aGF0LmhhbmRsZUZpbGVVcGxvYWRQcm9jZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICdlcnJvcic6IHRoYXQuaGFuZGxlRmlsZVVwbG9hZEVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICdjb21wbGV0ZSc6IHRoYXQuaGFuZGxlRmlsZVVwbG9hZENvbXBsZXRlXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICB9KVxuICB9KVxufTtcblxuQWRkVGVhY2hlci5wcm90b3R5cGUuaGFuZGxlRmlsZVVwbG9hZFByb2Nlc3MgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICB2YXIgdG90YWwgPSByZXNwb25zZS50b3RhbDtcbiAgICB2YXIgcGVyY2VudCA9IHRvdGFsLnBlcmNlbnQ7XG4gICAgdmFyIHBlcmNlbnRUZXh0ID0gcGVyY2VudC50b0ZpeGVkKDApICsgJyUnO1xuICAgIHZhciBwcm9ncmVzc0dyb3VwID0gQWRkVGVhY2hlci5wcm9ncmVzc0dyb3VwO1xuICAgIHByb2dyZXNzR3JvdXAuc2hvdygpO1xuXG4gICAgdmFyIHByb2dyZXNzQmFyID0gJCgnLnByb2dyZXNzLWJhcicpO1xuICAgIHByb2dyZXNzQmFyLmNzcyh7J3dpZHRoJzogcGVyY2VudFRleHR9KTtcbiAgICBwcm9ncmVzc0Jhci50ZXh0KHBlcmNlbnRUZXh0KTtcblxufTtcblxuQWRkVGVhY2hlci5wcm90b3R5cGUuaGFuZGxlRmlsZVVwbG9hZEVycm9yID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKHJlc3BvbnNlLm1lc3NhZ2UpO1xuICAgIHZhciBwcm9ncmVzc0dyb3VwID0gJCgnI3Byb2dyZXNzLWdyb3VwJyk7XG4gICAgcHJvZ3Jlc3NHcm91cC5oaWRlKCk7XG4gICAgY29uc29sZS5sb2cocmVzcG9uc2UubWVzc2FnZSk7XG59O1xuXG5BZGRUZWFjaGVyLnByb3RvdHlwZS5oYW5kbGVGaWxlVXBsb2FkQ29tcGxldGUgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSAkKCcjcHJvZ3Jlc3MtZ3JvdXAnKTtcbiAgICBwcm9ncmVzc0dyb3VwLmhpZGUoKTtcblxuICAgIHZhciBxaW5pdURvbWFpbiA9ICdodHRwOi8vcHRtb29scGZvLmJrdC5jbG91ZGRuLmNvbS8nO1xuICAgIHZhciBmaWxlTmFtZSA9IHJlc3BvbnNlLmtleTtcbiAgICB2YXIgdXJsID0gcWluaXVEb21haW4gKyBmaWxlTmFtZTtcbiAgICB2YXIgdGh1bWJuYWlsSW5wdXQgPSAkKCcjdGh1bWJuYWlsLWZvcm0nKTtcbiAgICB0aHVtYm5haWxJbnB1dC52YWwodXJsKTtcbn07XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBhZGRUZWFjaGVyID0gbmV3IEFkZFRlYWNoZXIoKTtcbiAgICBhZGRUZWFjaGVyLnJ1bigpO1xuICAgIEFkZFRlYWNoZXIucHJvZ3Jlc3NHcm91cCA9ICQoJyNwcm9ncmVzcy1ncm91cCcpO1xufSk7Il19
