function getCookie(t){var e=document.cookie.match("\\b"+t+"=([^;]*)\\b");return e?e[1]:void 0}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptchaBtn=$(".sms-captcha-btn")}function FrontBase(){}Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaCode(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show("fade")},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenImgCaptchaCode=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessSend=function(){var t=this,e=60;window.messageBox.showSuccess("短信验证码发送成功!"),t.smsCaptchaBtn.addClass("disabled"),t.smsCaptchaBtn.unbind("click");var n=setInterval(function(){t.smsCaptchaBtn.text(e+"s"),(e-=1)<=0&&(clearInterval(n),t.smsCaptchaBtn.removeClass("disabled"),t.smsCaptchaBtn.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,s=$('.signup-group input[name="telephone"]');n.smsCaptchaBtn.click(function(){var t=s.val();t||window.messageBox.show("请填写手机号！");var e={telephone:t};$.get({url:"/account/sms_captcha/",data:e,success:function(t){200===t.code?n.smsSuccessSend():alert(t.message)},error:function(){window.messageBox.showError("服务器内部错误!")}})})},Auth.prototype.listenShowHideEvent=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),s=$(".close-btn");e.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})}),s.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:0}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),e=t.find("input[name='telephone']"),n=t.find("input[name='password']"),s=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t={telephone:e.val(),password:n.val(),remember:s.prop("checked")?1:0};$.ajax({url:"/account/login/",type:"POST",data:t,headers:{"X-CSRFToken":getCookie("csrftoken")},success:function(t){if(200===t.code)a.hideEvent(),window.location.reload();else{var e=t.message;if("string"==typeof messagObje||e.constructor===String)window.messageBox.show(e);else for(var n in e){var s=e[n][0];window.messageBox.show(s)}}},error:function(){window.messageBox.showError("服务器内部错误!")}})})},Auth.prototype.listenSignupEvent=function(){var n=$(".signup-group");n.find(".submit-btn").click(function(t){t.preventDefault();var e={telephone:n.find('input[name="telephone"]').val(),username:n.find('input[name="username"]').val(),password1:n.find('input[name="password1"]').val(),password2:n.find('input[name="password2"]').val(),img_captcha:n.find('input[name="img_captcha"]').val(),sms_captcha:n.find('input[name="sms_captcha"]').val()};$.ajax({url:"/account/register/",data:e,type:"POST",headers:{"X-CSRFToken":getCookie("csrftoken")},success:function(t){if(200===t.code)window.messageBox.showSuccess("注册成功!"),window.location.reload();else{var e=t.message;if("string"==typeof messagObje||e.constructor===String)window.messageBox.show(e);else for(var n in e){var s=e[n][0];window.messageBox.show(s)}}}})})},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})},FrontBase.prototype.run=function(){this.listenAuthBoxHover(),this.listenSwitchBottom()},FrontBase.prototype.listenSwitchBottom=function(){var t=location.href,e=!1;$("#nav-info a").each(function(){-1<(t+"/").indexOf($(this).attr("href"))&&""!==$(this).attr("href")?($(this).addClass("active"),e=!0):$(this).removeClass("active")}),e||$("#nav-info a").eq(0).addClass("active")},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var e=new Date(t),n=e.getTime(),s=((new Date).getTime()-n)/1e3;return s<60?"刚刚":60<=s&&s<3600?parseInt(s/60)+"分钟前":3600<=s&&s<86400?parseInt(s/60/60)+"小时前":86400<=s&&s<2592e3?parseInt(s/60/60/24)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+":"+e.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250LWJhc2UuanMiXSwibmFtZXMiOlsiZ2V0Q29va2llIiwibmFtZSIsInIiLCJkb2N1bWVudCIsImNvb2tpZSIsIm1hdGNoIiwidW5kZWZpbmVkIiwiQXV0aCIsInRoYXQiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGFCdG4iLCJGcm9udEJhc2UiLCJwcm90b3R5cGUiLCJydW4iLCJsaXN0ZW5TaG93SGlkZUV2ZW50IiwibGlzdGVuU3dpdGNoRXZlbnQiLCJsaXN0ZW5TaWduaW5FdmVudCIsImxpc3RlbkltZ0NhcHRjaGFDb2RlIiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaG93RXZlbnQiLCJzaG93IiwiaGlkZUV2ZW50IiwiaGlkZSIsImltZ0NhcHRjaGEiLCJjbGljayIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwic21zU3VjY2Vzc1NlbmQiLCJjb3VudCIsIndpbmRvdyIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwidW5iaW5kIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsInRleHQiLCJjbGVhckludGVydmFsIiwicmVtb3ZlQ2xhc3MiLCJ0ZWxlcGhvbmVJbnB1dCIsInRlbGVwaG9uZVZhbCIsInZhbCIsImRhdGEiLCJ0ZWxlcGhvbmUiLCJnZXQiLCJ1cmwiLCJzdWNjZXNzIiwicmVzIiwiY29kZSIsImFsZXJ0IiwibWVzc2FnZSIsImVycm9yIiwic2hvd0Vycm9yIiwic2lnbmluQnRuIiwic2lnbnVwQnRuIiwiY2xvc2VCdG4iLCJjc3MiLCJsZWZ0IiwiY3VycmVudExlbmd0aCIsInBhcnNlSW50IiwiYW5pbWF0ZSIsInNpZ25pbkdyb3VwIiwiZmluZCIsInBhc3N3b3JkSW5wdXQiLCJyZW1lbWJlcklucHV0IiwicGFzc3dvcmQiLCJyZW1lbWJlciIsInByb3AiLCJhamF4IiwidHlwZSIsImhlYWRlcnMiLCJYLUNTUkZUb2tlbiIsImxvY2F0aW9uIiwicmVsb2FkIiwibWVzc2FnZU9iaiIsIm1lc3NhZ09iamUiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsImtleSIsInNpZ251cEdyb3VwIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJuYW1lIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwiaW1nX2NhcHRjaGEiLCJzbXNfY2FwdGNoYSIsImxpc3RlbkF1dGhCb3hIb3ZlciIsImF1dGhCb3giLCJ1c2VyTW9yZUJveCIsImhvdmVyIiwibGlzdGVuU3dpdGNoQm90dG9tIiwidXJsU3RyIiwiaHJlZiIsInVybFN0YXR1cyIsImVhY2giLCJpbmRleE9mIiwiZXEiLCJ0ZW1wbGF0ZSIsImRlZmF1bHRzIiwiaW1wb3J0cyIsInRpbWVTaW5jZSIsInZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsVUFBVUMsR0FDZixJQUFJQyxFQUFJQyxTQUFTQyxPQUFPQyxNQUFNLE1BQVFKLEVBQU8sZUFDN0MsT0FBT0MsRUFBSUEsRUFBRSxRQUFLSSxFQW9CdEIsU0FBU0MsT0FDTCxJQUFJQyxFQUFPQyxLQUNYRCxFQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsRUFBS0ksY0FBZ0JELEVBQUUsbUJBQ3ZCSCxFQUFLSyxjQUFnQkYsRUFBRSxvQkFtTzNCLFNBQVNHLGFBaE9UUCxLQUFLUSxVQUFVQyxJQUFNLFdBQ2pCLElBQUlSLEVBQU9DLEtBQ1hELEVBQUtTLHNCQUNMVCxFQUFLVSxvQkFDTFYsRUFBS1csb0JBQ0xYLEVBQUtZLHVCQUNMWixFQUFLYSx3QkFDTGIsRUFBS2MscUJBR1RmLEtBQUtRLFVBQVVRLFVBQVksV0FDWmQsS0FDTkMsWUFBWWMsS0FBSyxTQUcxQmpCLEtBQUtRLFVBQVVVLFVBQVksV0FDWmhCLEtBQ05DLFlBQVlnQixRQUdyQm5CLEtB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RixVQUFVQyxVQUFVaUYsbUJBQXFCLFdBQ3ZDLElBQUlDLEVBQVNwQixTQUFTcUIsS0FDbEJDLEdBQVksRUFFaEJ4RixFQUFFLGVBQWV5RixLQUFLLFlBQ2tDLEdBQS9DSCxFQUFTLEtBQUtJLFFBQVExRixFQUFFRixNQUFNb0IsS0FBSyxVQUEwQyxLQUF6QmxCLEVBQUVGLE1BQU1vQixLQUFLLFNBQ2xFbEIsRUFBRUYsTUFBTTRCLFNBQVMsVUFDakI4RCxHQUFZLEdBRVZ4RixFQUFFRixNQUFNa0MsWUFBWSxZQUd6QndELEdBQ0R4RixFQUFFLGVBQWUyRixHQUFHLEdBQUdqRSxTQUFTLFdBSXRDMUIsRUFBRSxZQUNhLElBQUlKLE1BQ1ZTLFFBR1RMLEVBQUUsWUFDa0IsSUFBSUcsV0FDVkUsUUFHZEwsRUFBRSxXQUNLdUIsT0FBT3FFLFdBQ1BBLFNBQVNDLFNBQVNDLFFBQVFDLFVBQVksU0FBVUMsR0FFL0MsSUFBSUMsRUFBTyxJQUFJQyxLQUFLRixHQUNoQkcsRUFBU0YsRUFBS0csVUFFZEMsSUFEUSxJQUFLSCxNQUFRRSxVQUNBRCxHQUFVLElBRW5DLE9BQUlFLEVBQVksR0FFTCxLQUNhLElBQWJBLEdBQW1CQSxFQUFZLEtBQ3hCaEQsU0FBU2dELEVBQVUsSUFFaEIsTUFDRyxNQUFiQSxHQUFzQkEsRUFBWSxNQUM3QmhELFNBQVNnRCxFQUFVLEdBQUcsSUFFbkIsTUFDSyxPQUFiQSxHQUF5QkEsRUFBWSxPQUNqQ2hELFNBQVNnRCxFQUFVLEdBQUcsR0FBRyxJQUN0QixLQUVISixFQUFLSyxjQU1GLElBTEZMLEVBQUtNLFdBS1csSUFKbEJOLEVBQUtPLFNBSXlCLElBSDdCUCxFQUFLUSxXQUdxQyxJQUZ4Q1IsRUFBS1MiLCJmaWxlIjoiZnJvbnQtYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xuICAgIHZhciByID0gZG9jdW1lbnQuY29va2llLm1hdGNoKFwiXFxcXGJcIiArIG5hbWUgKyBcIj0oW147XSopXFxcXGJcIik7XG4gICAgcmV0dXJuIHIgPyByWzFdIDogdW5kZWZpbmVkO1xufVxuLy8gZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcbi8vICAgICAgdmFyIGNvb2tpZVZhbHVlID0gbnVsbDtcbi8vICAgICAgaWYgKGRvY3VtZW50LmNvb2tpZSAmJiBkb2N1bWVudC5jb29raWUgIT09ICcnKSB7XG4vLyAgICAgICAgICB2YXIgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuLy8gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGpRdWVyeS50cmltKGNvb2tpZXNbaV0pO1xuLy8gICAgICAgICAgICAgIC8vIERvZXMgdGhpcyBjb29raWUgc3RyaW5nIGJlZ2luIHdpdGggdGhlIG5hbWUgd2Ugd2FudD9cbi8vICAgICAgICAgICAgICBpZiAoY29va2llLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCArIDEpID09PSAobmFtZSArICc9JykpIHtcbi8vICAgICAgICAgICAgICAgICAgY29va2llVmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoY29va2llLnN1YnN0cmluZyhuYW1lLmxlbmd0aCArIDEpKTtcbi8vICAgICAgICAgICAgICAgICAgYnJlYWs7XG4vLyAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgfVxuLy8gICAgICB9XG4vLyAgICAgIHJldHVybiBjb29raWVWYWx1ZTtcbi8vICB9XG5cblxuLy8g5aSE55CG55So5oi36K6k6K+BXG5mdW5jdGlvbiBBdXRoKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB0aGF0Lm1hc2tXcmFwcGVyID0gJCgnLm1hc2std3JhcHBlcicpO1xuICAgIHRoYXQuc2Nyb2xsV3JhcHBlciA9ICQoJy5zY3JvbGwtd3JhcHBlcicpO1xuICAgIHRoYXQuc21zQ2FwdGNoYUJ0biA9ICQoJy5zbXMtY2FwdGNoYS1idG4nKTtcbn1cblxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB0aGF0Lmxpc3RlblNob3dIaWRlRXZlbnQoKTtcbiAgICB0aGF0Lmxpc3RlblN3aXRjaEV2ZW50KCk7XG4gICAgdGhhdC5saXN0ZW5TaWduaW5FdmVudCgpO1xuICAgIHRoYXQubGlzdGVuSW1nQ2FwdGNoYUNvZGUoKTtcbiAgICB0aGF0Lmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xuICAgIHRoYXQubGlzdGVuU2lnbnVwRXZlbnQoKTtcbn07XG5cbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdGhhdC5tYXNrV3JhcHBlci5zaG93KCdmYWRlJyk7XG59O1xuXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHRoYXQubWFza1dyYXBwZXIuaGlkZSgpO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1nQ2FwdGNoYUNvZGUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBpbWdDYXB0Y2hhID0gJCgnLmltZy1jYXB0Y2hhJyk7XG4gIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgaW1nQ2FwdGNoYS5hdHRyKCdzcmMnLCAnL2FjY291bnQvaW1nX2NhcHRjaGEvJyArICc/cmFuZG9tPScgKyBNYXRoLnJhbmRvbSgpKVxuICB9KTtcbn07XG5cbkF1dGgucHJvdG90eXBlLnNtc1N1Y2Nlc3NTZW5kID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB2YXIgY291bnQgPSA2MDtcblxuICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfnn63kv6Hpqozor4HnoIHlj5HpgIHmiJDlip8hJyk7XG4gICAgdGhhdC5zbXNDYXB0Y2hhQnRuLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgIHRoYXQuc21zQ2FwdGNoYUJ0bi51bmJpbmQoJ2NsaWNrJyk7XG5cbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuc21zQ2FwdGNoYUJ0bi50ZXh0KGNvdW50ICsgJ3MnKTtcbiAgICAgICAgY291bnQgLT0gMTtcblxuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XG4gICAgICAgICAgICB0aGF0LnNtc0NhcHRjaGFCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB0aGF0LnNtc0NhcHRjaGFCdG4udGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7XG4gICAgICAgICAgICB0aGF0Lmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xuICAgICAgICB9XG4gICAgfSwgMTAwMClcblxufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoJy5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT1cInRlbGVwaG9uZVwiXScpO1xuXG4gIHRoYXQuc21zQ2FwdGNoYUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdGVsZXBob25lVmFsID0gdGVsZXBob25lSW5wdXQudmFsKCk7XG5cbiAgICAgIGlmICghdGVsZXBob25lVmFsKSB7XG4gICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdygn6K+35aGr5YaZ5omL5py65Y+377yBJylcbiAgICAgIH1cblxuICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZVZhbFxuICAgICAgfTtcblxuICAgICAgJC5nZXQoe1xuICAgICAgICAgIHVybDogJy9hY2NvdW50L3Ntc19jYXB0Y2hhLycsXG4gICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICB0aGF0LnNtc1N1Y2Nlc3NTZW5kKCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBhbGVydChyZXMubWVzc2FnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcign5pyN5Yqh5Zmo5YaF6YOo6ZSZ6K+vIScpXG4gICAgICAgICAgfVxuICAgICAgfSlcbiAgfSlcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHZhciBzaWduaW5CdG4gPSAkKCcuc2lnbmluLWJ0bicpO1xuICAgIHZhciBzaWdudXBCdG4gPSAkKCcuc2lnbnVwLWJ0bicpO1xuICAgIHZhciBjbG9zZUJ0biA9ICQoJy5jbG9zZS1idG4nKTtcblxuICAgIHNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuc2hvd0V2ZW50KCk7XG4gICAgICAgIHRoYXQuc2Nyb2xsV3JhcHBlci5jc3MoeydsZWZ0JzowfSk7XG4gICAgfSk7XG5cbiAgICBzaWdudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LnNob3dFdmVudCgpO1xuICAgICAgICB0aGF0LnNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6Jy00MDBweCd9KTtcbiAgICB9KTtcblxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhhdC5oaWRlRXZlbnQoKTtcbiAgICB9KVxufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHZhciBzd2l0Y2hCdG4gPSAkKCcuc3dpdGNoJyk7XG5cbiAgICBzd2l0Y2hCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VycmVudExlbmd0aCA9IHRoYXQuc2Nyb2xsV3JhcHBlci5jc3MoJ2xlZnQnKTtcbiAgICAgICAgY3VycmVudExlbmd0aCA9IHBhcnNlSW50KGN1cnJlbnRMZW5ndGgpO1xuXG4gICAgICAgIGlmIChjdXJyZW50TGVuZ3RoIDwgMCkge1xuICAgICAgICAgICAgdGhhdC5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoeydsZWZ0JzowfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGF0LnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7J2xlZnQnOiAnLTQwMHB4J30pO1xuICAgICAgICB9XG4gICAgfSlcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB2YXIgc2lnbmluR3JvdXAgPSAkKCcuc2lnbmluLWdyb3VwJyk7XG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xuICAgIHZhciBwYXNzd29yZElucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkJ11cIik7XG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncmVtZW1iZXInXVwiKTtcblxuICAgIHZhciBzaWduaW5CdG4gPSBzaWduaW5Hcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xuXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICB2YXIgdGVsZXBob25lVmFsID0gdGVsZXBob25lSW5wdXQudmFsKCk7XG4gICAgICAgdmFyIHBhc3N3b3JkVmFsID0gcGFzc3dvcmRJbnB1dC52YWwoKTtcbiAgICAgICB2YXIgcmVtZW1iZXJWYWwgPSByZW1lbWJlcklucHV0LnByb3AoJ2NoZWNrZWQnKTtcblxuICAgICAgIHZhciBkYXRhID0gIHtcbiAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZVZhbCxcbiAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmRWYWwsXG4gICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyVmFsID8gMSA6IDBcbiAgICAgICAgfTtcbiAgICAgICAvLyAgdmFyIGRhdGFfanNvbiA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGFfanNvbilcblxuICAgICAgICQuYWpheCh7XG4gICAgICAgICAgIHVybDogJy9hY2NvdW50L2xvZ2luLycsXG4gICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgJ1gtQ1NSRlRva2VuJzogZ2V0Q29va2llKCdjc3JmdG9rZW4nKVxuICAgICAgICAgICB9LFxuICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgIHRoYXQuaGlkZUV2ZW50KCk7XG4gICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iaiA9IHJlc1snbWVzc2FnZSddO1xuICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnT2JqZSA9PT0gJ3N0cmluZycgfHwgbWVzc2FnZU9iai5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3cobWVzc2FnZU9iaik7XG4gICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG1lc3NhZ2VPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmpba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9LFxuICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKCfmnI3liqHlmajlhoXpg6jplJnor68hJylcbiAgICAgICAgICAgfVxuICAgICAgIH0pXG4gICAgfSlcblxufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbnVwRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHZhciBzaWdudXBHcm91cCA9ICQoJy5zaWdudXAtZ3JvdXAnKTtcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbnVwR3JvdXAuZmluZCgnLnN1Ym1pdC1idG4nKTtcblxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIHRlbGVwaG9uZVZhbCA9IHNpZ251cEdyb3VwLmZpbmQoJ2lucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKS52YWwoKTtcbiAgICAgICAgdmFyIHVzZXJuYW1lVmFsID0gc2lnbnVwR3JvdXAuZmluZCgnaW5wdXRbbmFtZT1cInVzZXJuYW1lXCJdJykudmFsKCk7XG4gICAgICAgIHZhciBwYXNzd29yZDFWYWwgPSBzaWdudXBHcm91cC5maW5kKCdpbnB1dFtuYW1lPVwicGFzc3dvcmQxXCJdJykudmFsKCk7XG4gICAgICAgIHZhciBwYXNzd29yZDJWYWwgPSBzaWdudXBHcm91cC5maW5kKCdpbnB1dFtuYW1lPVwicGFzc3dvcmQyXCJdJykudmFsKCk7XG4gICAgICAgIHZhciBpbWdfY2FwdGNoYVZhbCA9IHNpZ251cEdyb3VwLmZpbmQoJ2lucHV0W25hbWU9XCJpbWdfY2FwdGNoYVwiXScpLnZhbCgpO1xuICAgICAgICB2YXIgc21zX2NhcHRjaGFWYWwgPSBzaWdudXBHcm91cC5maW5kKCdpbnB1dFtuYW1lPVwic21zX2NhcHRjaGFcIl0nKS52YWwoKTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmVWYWwsXG4gICAgICAgICAgICAndXNlcm5hbWUnOiB1c2VybmFtZVZhbCxcbiAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDFWYWwsXG4gICAgICAgICAgICAncGFzc3dvcmQyJzogcGFzc3dvcmQyVmFsLFxuICAgICAgICAgICAgJ2ltZ19jYXB0Y2hhJzogaW1nX2NhcHRjaGFWYWwsXG4gICAgICAgICAgICAnc21zX2NhcHRjaGEnOiBzbXNfY2FwdGNoYVZhbFxuICAgICAgICB9O1xuXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcvYWNjb3VudC9yZWdpc3Rlci8nLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICdYLUNTUkZUb2tlbic6IGdldENvb2tpZSgnY3NyZnRva2VuJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+azqOWGjOaIkOWKnyEnKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VPYmogPSByZXNbJ21lc3NhZ2UnXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdPYmplID09PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG1lc3NhZ2VPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmpba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn07XG5cbi8vIOWkhOeQhmhvdmVy5Ye65p2l55qE5a+86Iiq5p2hXG5mdW5jdGlvbiBGcm9udEJhc2UoKSB7XG5cbn1cblxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGF1dGhCb3ggPSAkKCcuYXV0aC1ib3gnKTtcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKCcudXNlci1tb3JlLWJveCcpO1xuXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKTtcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKTtcbiAgICB9KTtcbn07XG5cbkZyb250QmFzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoYXQubGlzdGVuQXV0aEJveEhvdmVyKCk7XG4gIHRoYXQubGlzdGVuU3dpdGNoQm90dG9tKCk7XG59O1xuXG4vLyBGcm9udEJhc2UucHJvdG90eXBlLmxpc3RlblN3aXRjaEJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcbi8vICAgICB2YXIgaW5mb05hdiA9ICQoJyNuYXYtaW5mbycpO1xuLy8gICAgIHZhciBpbmRleCA9IGluZm9OYXYuZmluZCgnbGk6Zmlyc3QnKTtcbi8vICAgICBpbmRleC5hZGRDbGFzcygnYWN0aXZlJyk7XG4vL1xuLy8gICAgIGluZm9OYXYuY2hpbGRyZW4oKS5jbGljayhmdW5jdGlvbiAoKSB7XG4vLyAgICAgICAgIHZhciBidG4gPSAkKHRoaXMpO1xuLy8gICAgICAgICB2YXIgdXJsID0ge1xuLy8gICAgICAgICAgICAgJ2luZm9fdXJsJzogJy8nLFxuLy8gICAgICAgICAgICAgJ2NvdXJzZV91cmwnOiAnL2NvdXJzZS8nLFxuLy8gICAgICAgICAgICAgJ3BheWluZm9fdXJsJzogJy9wYXlpbmZvLycsXG4vLyAgICAgICAgICAgICAnc2VhcmNoX3VybCc6ICcvc2VhcmNoLydcbi8vICAgICAgICAgfTtcbi8vICAgICAgICAgdmFyIGN1cnJlbnRVcmwgPSBidG4uYXR0cignaHJlZicpO1xuLy8gICAgICAgICBpZiAoY3VycmVudFVybCA9PT0gdXJsLmluZm9fdXJsKSB7XG4vLyAgICAgICAgICAgICBpbmRleC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgLy8gYnRuLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICB9IGVsc2UgaWYoY3VycmVudFVybD09PXVybC5jb3Vyc2VfdXJsKSB7XG4vLyAgICAgICAgICAgICBpbmRleC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgLy8gYnRuLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRVcmw9PT11cmwucGF5aW5mb191cmwpIHtcbi8vICAgICAgICAgICAgIGluZGV4LnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgIGJ0bi5hZGRDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICAvLyBidG4uc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICBpbmRleC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgLy8gYnRuLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICB9XG4vLyAgICAgfSlcbi8vIH07XG5cbkZyb250QmFzZS5wcm90b3R5cGUubGlzdGVuU3dpdGNoQm90dG9tID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdXJsU3RyID0gbG9jYXRpb24uaHJlZjtcbiAgdmFyIHVybFN0YXR1cyA9IGZhbHNlO1xuXG4gICQoJyNuYXYtaW5mbyBhJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgaWYgKCh1cmxTdHIgKyAnLycpLmluZGV4T2YoJCh0aGlzKS5hdHRyKCdocmVmJykpID4gLTEgJiYgJCh0aGlzKS5hdHRyKCdocmVmJykgIT09ICcnKSB7XG4gICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgdXJsU3RhdHVzID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuICAgICAgfVxuICB9KTtcbiAgaWYgKCF1cmxTdGF0dXMpIHtcbiAgICAgICQoJyNuYXYtaW5mbyBhJykuZXEoMCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICB9XG59O1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XG4gICAgYXV0aC5ydW4oKTtcbn0pO1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZnJvbnRCYXNlID0gbmV3IEZyb250QmFzZSgpO1xuICAgIGZyb250QmFzZS5ydW4oKTtcbn0pO1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgIGlmICh3aW5kb3cudGVtcGxhdGUpIHtcbiAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAvLyBhcnRfdGVtcGxhdGXmqKHmnb/ov4fmu6TlmajvvIzmoLzlvI/ljJbml7bpl7RcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gICAgICAgIHZhciBkYXRldHMgPSBkYXRlLmdldFRpbWUoKTtcbiAgICAgICAgdmFyIG5vd3RzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IChub3d0cyAtIGRhdGV0cykgLyAxMDAwOyAvL+W+l+WIsOS4pOiAheebuOW3rueahOaXtumXtOaIs++8jOWNleS9jeS4uuenklxuXG4gICAgICAgIGlmICh0aW1lc3RhbXAgPCA2MCkge1xuXG4gICAgICAgICAgICByZXR1cm4gXCLliJrliJpcIlxuICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCAmJiB0aW1lc3RhbXAgPCA2MCo2MCkge1xuICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAvNjApO1xuXG4gICAgICAgICAgICByZXR1cm4gbWludXRlcyArICfliIbpkp/liY0nXG4gICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwKjYwICYmIHRpbWVzdGFtcCA8IDYwKjYwKjI0KSB7XG4gICAgICAgICAgICB2YXIgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAvNjAvNjApO1xuXG4gICAgICAgICAgICByZXR1cm4gaG91cnMgKyAn5bCP5pe25YmNJ1xuICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCozMCkge1xuICAgICAgICAgICAgdmFyIGRheXMgPSBwYXJzZUludCh0aW1lc3RhbXAvNjAvNjAvMjQpO1xuICAgICAgICAgICAgcmV0dXJuIGRheXMgKyAn5aSp5YmNJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgdmFyIG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xuXG4gICAgICAgICAgICByZXR1cm4geWVhciArICcvJyArIG1vbnRoICsgJy8nICsgZGF5ICsgJyAnICsgaG91ciArICc6JyArIG1pbnV0ZVxuICAgICAgICB9XG4gICAgfTtcbiAgIH1cbn0pO1xuIl19
