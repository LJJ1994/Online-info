function getCookie(t){var e=document.cookie.match("\\b"+t+"=([^;]*)\\b");return e?e[1]:void 0}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptchaBtn=$(".sms-captcha-btn")}function FrontBase(){}Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaCode(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show("fade")},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenImgCaptchaCode=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessSend=function(){var t=this,e=60;window.messageBox.showSuccess("短信验证码发送成功!"),t.smsCaptchaBtn.addClass("disabled"),t.smsCaptchaBtn.unbind("click");var n=setInterval(function(){t.smsCaptchaBtn.text(e+"s"),(e-=1)<=0&&(clearInterval(n),t.smsCaptchaBtn.removeClass("disabled"),t.smsCaptchaBtn.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,s=$('.signup-group input[name="telephone"]');n.smsCaptchaBtn.click(function(){var t=s.val();t||window.messageBox.show("请填写手机号！");var e={telephone:t};$.get({url:"/account/sms_captcha/",data:e,success:function(t){200===t.code?n.smsSuccessSend():alert(t.message)},error:function(){window.messageBox.showError("服务器内部错误!")}})})},Auth.prototype.listenShowHideEvent=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),s=$(".close-btn");e.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})}),s.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:0}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var o=this,t=$(".signin-group"),e=t.find("input[name='telephone']"),n=t.find("input[name='password']"),s=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t={telephone:e.val(),password:n.val(),remember:s.prop("checked")?1:0};$.ajax({url:"/account/login/",type:"POST",data:t,headers:{"X-CSRFToken":getCookie("csrftoken")},success:function(t){if(200===t.code)o.hideEvent(),window.location.reload();else{var e=t.message;if("string"==typeof messagObje||e.constructor===String)window.messageBox.show(e);else for(var n in e){var s=e[n][0];window.messageBox.show(s)}}},error:function(){window.messageBox.showError("服务器内部错误!")}})})},Auth.prototype.listenSignupEvent=function(){var n=$(".signup-group");n.find(".submit-btn").click(function(t){t.preventDefault();var e={telephone:n.find('input[name="telephone"]').val(),username:n.find('input[name="username"]').val(),password1:n.find('input[name="password1"]').val(),password2:n.find('input[name="password2"]').val(),img_captcha:n.find('input[name="img_captcha"]').val(),sms_captcha:n.find('input[name="sms_captcha"]').val()};$.ajax({url:"/account/register/",data:e,type:"POST",success:function(t){if(200===t.code)window.messageBox.showSuccess("注册成功!"),window.location.reload();else{var e=t.message;if("string"==typeof messagObje||e.constructor===String)window.messageBox.show(e);else for(var n in e){var s=e[n][0];window.messageBox.show(s)}}}})})},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})},FrontBase.prototype.run=function(){this.listenAuthBoxHover(),this.listenSwitchBottom()},FrontBase.prototype.listenSwitchBottom=function(){},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var e=new Date(t),n=e.getTime(),s=((new Date).getTime()-n)/1e3;return s<60?"刚刚":60<=s&&s<3600?parseInt(s/60)+"分钟前":3600<=s&&s<86400?parseInt(s/60/60)+"小时前":86400<=s&&s<2592e3?parseInt(s/60/60/24)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+":"+e.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250LWJhc2UuanMiXSwibmFtZXMiOlsiZ2V0Q29va2llIiwibmFtZSIsInIiLCJkb2N1bWVudCIsImNvb2tpZSIsIm1hdGNoIiwidW5kZWZpbmVkIiwiQXV0aCIsInRoYXQiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGFCdG4iLCJGcm9udEJhc2UiLCJwcm90b3R5cGUiLCJydW4iLCJsaXN0ZW5TaG93SGlkZUV2ZW50IiwibGlzdGVuU3dpdGNoRXZlbnQiLCJsaXN0ZW5TaWduaW5FdmVudCIsImxpc3RlbkltZ0NhcHRjaGFDb2RlIiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaG93RXZlbnQiLCJzaG93IiwiaGlkZUV2ZW50IiwiaGlkZSIsImltZ0NhcHRjaGEiLCJjbGljayIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwic21zU3VjY2Vzc1NlbmQiLCJjb3VudCIsIndpbmRvdyIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwidW5iaW5kIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsInRleHQiLCJjbGVhckludGVydmFsIiwicmVtb3ZlQ2xhc3MiLCJ0ZWxlcGhvbmVJbnB1dCIsInRlbGVwaG9uZVZhbCIsInZhbCIsImRhdGEiLCJ0ZWxlcGhvbmUiLCJnZXQiLCJ1cmwiLCJzdWNjZXNzIiwicmVzIiwiY29kZSIsImFsZXJ0IiwibWVzc2FnZSIsImVycm9yIiwic2hvd0Vycm9yIiwic2lnbmluQnRuIiwic2lnbnVwQnRuIiwiY2xvc2VCdG4iLCJjc3MiLCJsZWZ0IiwiY3VycmVudExlbmd0aCIsInBhcnNlSW50IiwiYW5pbWF0ZSIsInNpZ25pbkdyb3VwIiwiZmluZCIsInBhc3N3b3JkSW5wdXQiLCJyZW1lbWJlcklucHV0IiwicGFzc3dvcmQiLCJyZW1lbWJlciIsInByb3AiLCJhamF4IiwidHlwZSIsImhlYWRlcnMiLCJYLUNTUkZUb2tlbiIsImxvY2F0aW9uIiwicmVsb2FkIiwibWVzc2FnZU9iaiIsIm1lc3NhZ09iamUiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsImtleSIsInNpZ251cEdyb3VwIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJuYW1lIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwiaW1nX2NhcHRjaGEiLCJzbXNfY2FwdGNoYSIsImxpc3RlbkF1dGhCb3hIb3ZlciIsImF1dGhCb3giLCJ1c2VyTW9yZUJveCIsImhvdmVyIiwibGlzdGVuU3dpdGNoQm90dG9tIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJ2YWx1ZSIsImRhdGUiLCJEYXRlIiwiZGF0ZXRzIiwiZ2V0VGltZSIsInRpbWVzdGFtcCIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFVBQVVDLEdBQ2YsSUFBSUMsRUFBSUMsU0FBU0MsT0FBT0MsTUFBTSxNQUFRSixFQUFPLGVBQzdDLE9BQU9DLEVBQUlBLEVBQUUsUUFBS0ksRUFvQnRCLFNBQVNDLE9BQ0wsSUFBSUMsRUFBT0MsS0FDWEQsRUFBS0UsWUFBY0MsRUFBRSxpQkFDckJILEVBQUtJLGNBQWdCRCxFQUFFLG1CQUN2QkgsRUFBS0ssY0FBZ0JGLEVBQUUsb0JBbU8zQixTQUFTRyxhQWhPVFAsS0FBS1EsVUFBVUMsSUFBTSxXQUNqQixJQUFJUixFQUFPQyxLQUNYRCxFQUFLUyxzQkFDTFQsRUFBS1Usb0JBQ0xWLEVBQUtXLG9CQUNMWCxFQUFLWSx1QkFDTFosRUFBS2Esd0JBQ0xiLEVBQUtjLHFCQUdUZixLQUFLUSxVQUFVUSxVQUFZLFdBQ1pkLEtBQ05DLFlBQVljLEtBQUssU0FHMUJqQixLQUFLUSxVQUFVVSxVQUFZLFdBQ1poQixLQUNOQyxZQUFZZ0IsUUFHckJuQixLQUFLUSxVQUFVSyxxQkFBdUIsV0FDcEMsSUFBSU8sRUFBYWhCLEVBQUUsZ0JBQ25CZ0IsRUFBV0MsTUFBTSxXQUNiRCxFQUFXRSxLQUFLLE1BQU8sZ0NBQXVDQyxLQUFLQyxhQUl6RXhCLEtBQUtRLFVBQVVpQixlQUFpQixXQUM1QixJQUFJeEIsRUFBT0MsS0FDUHdCLEVBQVEsR0FFWkMsT0FBT0MsV0FBV0MsWUFBWSxjQUM5QjVCLEVBQUtLLGNBQWN3QixTQUFTLFlBQzVCN0IsRUFBS0ssY0FBY3lCLE9BQU8sU0FFMUIsSUFBSUMsRUFBUUMsWUFBWSxXQUNwQmhDLEVBQUtLLGNBQWM0QixLQUFLUixFQUFRLE1BQ2hDQSxHQUFTLElBRUksSUFDVFMsY0FBY0gsR0FDZC9CLEVBQUtLLGNBQWM4QixZQUFZLFlBQy9CbkMsRUFBS0ssY0FBYzRCLEtBQUssU0FDeEJqQyxFQUFLYSwwQkFFVixNQUlQZCxLQUFLUSxVQUFVTSxzQkFBd0IsV0FDckMsSUFBSWIsRUFBT0MsS0FDUG1DLEVBQWlCakMsRUFBRSx5Q0FFdkJILEVBQUtLLGNBQWNlLE1BQU0sV0FDckIsSUFBSWlCLEVBQWVELEVBQWVFLE1BRTdCRCxHQUNEWCxPQUFPQyxXQUFXWCxLQUFLLFdBRzNCLElBQUl1QixFQUFPLENBQ1BDLFVBQWFILEdBR2pCbEMsRUFBRXNDLElBQUksQ0FDRkMsSUFBSyx3QkFDTEgsS0FBTUEsRUFDTkksUUFBUyxTQUFVQyxHQUNFLE1BQWJBLEVBQUlDLEtBQ0o3QyxFQUFLd0IsaUJBRUxzQixNQUFNRixFQUFJRyxVQUdsQkMsTUFBTyxXQUNIdEIsT0FBT0MsV0FBV3NCLFVBQVUsa0JBTTFDbEQsS0FBS1EsVUFBVUUsb0JBQXNCLFdBQ2pDLElBQUlULEVBQU9DLEtBQ1BpRCxFQUFZL0MsRUFBRSxlQUNkZ0QsRUFBWWhELEVBQUUsZUFDZGlELEVBQVdqRCxFQUFFLGNBRWpCK0MsRUFBVTlCLE1BQU0sV0FDWnBCLEVBQUtlLFlBQ0xmLEVBQUtJLGNBQWNpRCxJQUFJLENBQUNDLEtBQU8sTUFHbkNILEVBQVUvQixNQUFNLFdBQ1pwQixFQUFLZSxZQUNMZixFQUFLSSxjQUFjaUQsSUFBSSxDQUFDQyxLQUFPLGFBR25DRixFQUFTaEMsTUFBTSxXQUNYcEIsRUFBS2lCLGVBSWJsQixLQUFLUSxVQUFVRyxrQkFBb0IsV0FDL0IsSUFBSVYsRUFBT0MsS0FDS0UsRUFBRSxXQUVSaUIsTUFBTSxXQUNaLElBQUltQyxFQUFnQnZELEVBQUtJLGNBQWNpRCxJQUFJLFNBQzNDRSxFQUFnQkMsU0FBU0QsSUFFTCxFQUNoQnZELEVBQUtJLGNBQWNxRCxRQUFRLENBQUNILEtBQU8sSUFFbkN0RCxFQUFLSSxjQUFjcUQsUUFBUSxDQUFDSCxLQUFRLGNBS2hEdkQsS0FBS1EsVUFBVUksa0JBQW9CLFdBQy9CLElBQUlYLEVBQU9DLEtBQ1B5RCxFQUFjdkQsRUFBRSxpQkFDaEJpQyxFQUFpQnNCLEVBQVlDLEtBQUssMkJBQ2xDQyxFQUFnQkYsRUFBWUMsS0FBSywwQkFDakNFLEVBQWdCSCxFQUFZQyxLQUFLLDBCQUVyQkQsRUFBWUMsS0FBSyxlQUV2QnZDLE1BQU0sV0FDYixJQUlJbUIsRUFBUSxDQUNSQyxVQUxlSixFQUFlRSxNQU05QndCLFNBTGNGLEVBQWN0QixNQU01QnlCLFNBTGNGLEVBQWNHLEtBQUssV0FLUCxFQUFJLEdBS2xDN0QsRUFBRThELEtBQUssQ0FDSHZCLElBQUssa0JBQ0x3QixLQUFNLE9BQ04zQixLQUFNQSxFQUNONEIsUUFBUyxDQUNMQyxjQUFlNUUsVUFBVSxjQUU3Qm1ELFFBQVMsU0FBVUMsR0FDZixHQUFpQixNQUFiQSxFQUFJQyxLQUNKN0MsRUFBS2lCLFlBQ0xTLE9BQU8yQyxTQUFTQyxhQUNiLENBQ0gsSUFBSUMsRUFBYTNCLEVBQWEsUUFDOUIsR0FBMEIsaUJBQWY0QixZQUEyQkQsRUFBV0UsY0FBZ0JDLE9BQzdEaEQsT0FBT0MsV0FBV1gsS0FBS3VELFFBRXZCLElBQUssSUFBSUksS0FBT0osRUFBWSxDQUN4QixJQUNJeEIsRUFEV3dCLEVBQVdJLEdBQ0gsR0FDdkJqRCxPQUFPQyxXQUFXWCxLQUFLK0IsTUFLdkNDLE1BQU8sV0FDSHRCLE9BQU9DLFdBQVdzQixVQUFVLGtCQU8zQ2xELEtBQUtRLFVBQVVPLGtCQUFvQixXQUMvQixJQUNJOEQsRUFBY3pFLEVBQUUsaUJBQ0p5RSxFQUFZakIsS0FBSyxlQUV2QnZDLE1BQU0sU0FBVXlELEdBQ3RCQSxFQUFNQyxpQkFDTixJQU9JdkMsRUFBTyxDQUNQQyxVQVJlb0MsRUFBWWpCLEtBQUssMkJBQTJCckIsTUFTM0R5QyxTQVJjSCxFQUFZakIsS0FBSywwQkFBMEJyQixNQVN6RDBDLFVBUmVKLEVBQVlqQixLQUFLLDJCQUEyQnJCLE1BUzNEMkMsVUFSZUwsRUFBWWpCLEtBQUssMkJBQTJCckIsTUFTM0Q0QyxZQVJpQk4sRUFBWWpCLEtBQUssNkJBQTZCckIsTUFTL0Q2QyxZQVJpQlAsRUFBWWpCLEtBQUssNkJBQTZCckIsT0FXbkVuQyxFQUFFOEQsS0FBSyxDQUNIdkIsSUFBSyxxQkFDTEgsS0FBTUEsRUFDTjJCLEtBQU0sT0FJTnZCLFFBQVMsU0FBVUMsR0FDZixHQUFpQixNQUFiQSxFQUFJQyxLQUNKbkIsT0FBT0MsV0FBV0MsWUFBWSxTQUM5QkYsT0FBTzJDLFNBQVNDLGFBQ2QsQ0FDRixJQUFJQyxFQUFhM0IsRUFBYSxRQUM5QixHQUEwQixpQkFBZjRCLFlBQTJCRCxFQUFXRSxjQUFnQkMsT0FDOURoRCxPQUFPQyxXQUFXWCxLQUFLdUQsUUFFdkIsSUFBSyxJQUFJSSxLQUFPSixFQUFZLENBQ3hCLElBQ0l4QixFQURXd0IsRUFBV0ksR0FDSCxHQUN2QmpELE9BQU9DLFdBQVdYLEtBQUsrQixXQWNsRHpDLFVBQVVDLFVBQVU2RSxtQkFBcUIsV0FDckMsSUFBSUMsRUFBVWxGLEVBQUUsYUFDWm1GLEVBQWNuRixFQUFFLGtCQUVwQmtGLEVBQVFFLE1BQU0sV0FDVkQsRUFBWXRFLFFBQ2IsV0FDQ3NFLEVBQVlwRSxVQUlwQlosVUFBVUMsVUFBVUMsSUFBTSxXQUNiUCxLQUNObUYscUJBRE1uRixLQUVOdUYsc0JBcUNQbEYsVUFBVUMsVUFBVWlGLG1CQUFxQixhQWF6Q3JGLEVBQUUsWUFDYSxJQUFJSixNQUNWUyxRQUdUTCxFQUFFLFlBQ2tCLElBQUlHLFdBQ1ZFLFFBR2RMLEVBQUUsV0FDS3VCLE9BQU8rRCxXQUNQQSxTQUFTQyxTQUFTQyxRQUFRQyxVQUFZLFNBQVVDLEdBRS9DLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQVNGLEVBQUtHLFVBRWRDLElBRFEsSUFBS0gsTUFBUUUsVUFDQUQsR0FBVSxJQUVuQyxPQUFJRSxFQUFZLEdBRUwsS0FDYSxJQUFiQSxHQUFtQkEsRUFBWSxLQUN4QjFDLFNBQVMwQyxFQUFVLElBRWhCLE1BQ0csTUFBYkEsR0FBc0JBLEVBQVksTUFDN0IxQyxTQUFTMEMsRUFBVSxHQUFHLElBRW5CLE1BQ0ssT0FBYkEsR0FBeUJBLEVBQVksT0FDakMxQyxTQUFTMEMsRUFBVSxHQUFHLEdBQUcsSUFDdEIsS0FFSEosRUFBS0ssY0FNRixJQUxGTCxFQUFLTSxXQUtXLElBSmxCTixFQUFLTyxTQUl5QixJQUg3QlAsRUFBS1EsV0FHcUMsSUFGeENSLEVBQUtTIiwiZmlsZSI6ImZyb250LWJhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcbiAgICB2YXIgciA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaChcIlxcXFxiXCIgKyBuYW1lICsgXCI9KFteO10qKVxcXFxiXCIpO1xuICAgIHJldHVybiByID8gclsxXSA6IHVuZGVmaW5lZDtcbn1cbi8vIGZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XG4vLyAgICAgIHZhciBjb29raWVWYWx1ZSA9IG51bGw7XG4vLyAgICAgIGlmIChkb2N1bWVudC5jb29raWUgJiYgZG9jdW1lbnQuY29va2llICE9PSAnJykge1xuLy8gICAgICAgICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcbi8vICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xuLy8gICAgICAgICAgICAgIHZhciBjb29raWUgPSBqUXVlcnkudHJpbShjb29raWVzW2ldKTtcbi8vICAgICAgICAgICAgICAvLyBEb2VzIHRoaXMgY29va2llIHN0cmluZyBiZWdpbiB3aXRoIHRoZSBuYW1lIHdlIHdhbnQ/XG4vLyAgICAgICAgICAgICAgaWYgKGNvb2tpZS5zdWJzdHJpbmcoMCwgbmFtZS5sZW5ndGggKyAxKSA9PT0gKG5hbWUgKyAnPScpKSB7XG4vLyAgICAgICAgICAgICAgICAgIGNvb2tpZVZhbHVlID0gZGVjb2RlVVJJQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcobmFtZS5sZW5ndGggKyAxKSk7XG4vLyAgICAgICAgICAgICAgICAgIGJyZWFrO1xuLy8gICAgICAgICAgICAgIH1cbi8vICAgICAgICAgIH1cbi8vICAgICAgfVxuLy8gICAgICByZXR1cm4gY29va2llVmFsdWU7XG4vLyAgfVxuXG5cbi8vIOWkhOeQhueUqOaIt+iupOivgVxuZnVuY3Rpb24gQXV0aCgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdGhhdC5tYXNrV3JhcHBlciA9ICQoJy5tYXNrLXdyYXBwZXInKTtcbiAgICB0aGF0LnNjcm9sbFdyYXBwZXIgPSAkKCcuc2Nyb2xsLXdyYXBwZXInKTtcbiAgICB0aGF0LnNtc0NhcHRjaGFCdG4gPSAkKCcuc21zLWNhcHRjaGEtYnRuJyk7XG59XG5cbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdGhhdC5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XG4gICAgdGhhdC5saXN0ZW5Td2l0Y2hFdmVudCgpO1xuICAgIHRoYXQubGlzdGVuU2lnbmluRXZlbnQoKTtcbiAgICB0aGF0Lmxpc3RlbkltZ0NhcHRjaGFDb2RlKCk7XG4gICAgdGhhdC5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcbiAgICB0aGF0Lmxpc3RlblNpZ251cEV2ZW50KCk7XG59O1xuXG5BdXRoLnByb3RvdHlwZS5zaG93RXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHRoYXQubWFza1dyYXBwZXIuc2hvdygnZmFkZScpO1xufTtcblxuQXV0aC5wcm90b3R5cGUuaGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB0aGF0Lm1hc2tXcmFwcGVyLmhpZGUoKTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlbkltZ0NhcHRjaGFDb2RlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgaW1nQ2FwdGNoYSA9ICQoJy5pbWctY2FwdGNoYScpO1xuICBpbWdDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIGltZ0NhcHRjaGEuYXR0cignc3JjJywgJy9hY2NvdW50L2ltZ19jYXB0Y2hhLycgKyAnP3JhbmRvbT0nICsgTWF0aC5yYW5kb20oKSlcbiAgfSk7XG59O1xuXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzU2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdmFyIGNvdW50ID0gNjA7XG5cbiAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93U3VjY2Vzcygn55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5YqfIScpO1xuICAgIHRoYXQuc21zQ2FwdGNoYUJ0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICB0aGF0LnNtc0NhcHRjaGFCdG4udW5iaW5kKCdjbGljaycpO1xuXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LnNtc0NhcHRjaGFCdG4udGV4dChjb3VudCArICdzJyk7XG4gICAgICAgIGNvdW50IC09IDE7XG5cbiAgICAgICAgaWYgKGNvdW50IDw9IDApIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xuICAgICAgICAgICAgdGhhdC5zbXNDYXB0Y2hhQnRuLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgdGhhdC5zbXNDYXB0Y2hhQnRuLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xuICAgICAgICAgICAgdGhhdC5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcbiAgICAgICAgfVxuICAgIH0sIDEwMDApXG5cbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKCcuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKTtcblxuICB0aGF0LnNtc0NhcHRjaGFCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHRlbGVwaG9uZVZhbCA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xuXG4gICAgICBpZiAoIXRlbGVwaG9uZVZhbCkge1xuICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3coJ+ivt+Whq+WGmeaJi+acuuWPt++8gScpXG4gICAgICB9XG5cbiAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmVWYWxcbiAgICAgIH07XG5cbiAgICAgICQuZ2V0KHtcbiAgICAgICAgICB1cmw6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxuICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgdGhhdC5zbXNTdWNjZXNzU2VuZCgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgYWxlcnQocmVzLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoJ+acjeWKoeWZqOWGhemDqOmUmeivryEnKVxuICAgICAgICAgIH1cbiAgICAgIH0pXG4gIH0pXG59O1xuXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93SGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB2YXIgc2lnbmluQnRuID0gJCgnLnNpZ25pbi1idG4nKTtcbiAgICB2YXIgc2lnbnVwQnRuID0gJCgnLnNpZ251cC1idG4nKTtcbiAgICB2YXIgY2xvc2VCdG4gPSAkKCcuY2xvc2UtYnRuJyk7XG5cbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LnNob3dFdmVudCgpO1xuICAgICAgICB0aGF0LnNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6MH0pO1xuICAgIH0pO1xuXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhhdC5zaG93RXZlbnQoKTtcbiAgICAgICAgdGhhdC5zY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOictNDAwcHgnfSk7XG4gICAgfSk7XG5cbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuaGlkZUV2ZW50KCk7XG4gICAgfSlcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblN3aXRjaEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB2YXIgc3dpdGNoQnRuID0gJCgnLnN3aXRjaCcpO1xuXG4gICAgc3dpdGNoQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRMZW5ndGggPSB0aGF0LnNjcm9sbFdyYXBwZXIuY3NzKCdsZWZ0Jyk7XG4gICAgICAgIGN1cnJlbnRMZW5ndGggPSBwYXJzZUludChjdXJyZW50TGVuZ3RoKTtcblxuICAgICAgICBpZiAoY3VycmVudExlbmd0aCA8IDApIHtcbiAgICAgICAgICAgIHRoYXQuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHsnbGVmdCc6MH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhhdC5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoeydsZWZ0JzogJy00MDBweCd9KTtcbiAgICAgICAgfVxuICAgIH0pXG59O1xuXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWduaW5FdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcbiAgICB2YXIgcGFzc3dvcmRJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XG5cbiAgICB2YXIgc2lnbmluQnRuID0gc2lnbmluR3JvdXAuZmluZCgnLnN1Ym1pdC1idG4nKTtcblxuICAgIHNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgdmFyIHRlbGVwaG9uZVZhbCA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xuICAgICAgIHZhciBwYXNzd29yZFZhbCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XG4gICAgICAgdmFyIHJlbWVtYmVyVmFsID0gcmVtZW1iZXJJbnB1dC5wcm9wKCdjaGVja2VkJyk7XG5cbiAgICAgICB2YXIgZGF0YSA9ICB7XG4gICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmVWYWwsXG4gICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkVmFsLFxuICAgICAgICAgICAncmVtZW1iZXInOiByZW1lbWJlclZhbCA/IDEgOiAwXG4gICAgICAgIH07XG4gICAgICAgLy8gIHZhciBkYXRhX2pzb24gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhX2pzb24pXG5cbiAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICB1cmw6ICcvYWNjb3VudC9sb2dpbi8nLFxuICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICdYLUNTUkZUb2tlbic6IGdldENvb2tpZSgnY3NyZnRva2VuJylcbiAgICAgICAgICAgfSxcbiAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICB0aGF0LmhpZGVFdmVudCgpO1xuICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VPYmogPSByZXNbJ21lc3NhZ2UnXTtcbiAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ09iamUgPT09ICdzdHJpbmcnIHx8IG1lc3NhZ2VPYmouY29uc3RydWN0b3IgPT09IFN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmopO1xuICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBtZXNzYWdlT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBtZXNzYWdlT2JqW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IG1lc3NhZ2VzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfSxcbiAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcign5pyN5Yqh5Zmo5YaF6YOo6ZSZ6K+vIScpXG4gICAgICAgICAgIH1cbiAgICAgICB9KVxuICAgIH0pXG5cbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICB2YXIgc2lnbnVwR3JvdXAgPSAkKCcuc2lnbnVwLWdyb3VwJyk7XG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoJy5zdWJtaXQtYnRuJyk7XG5cbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciB0ZWxlcGhvbmVWYWwgPSBzaWdudXBHcm91cC5maW5kKCdpbnB1dFtuYW1lPVwidGVsZXBob25lXCJdJykudmFsKCk7XG4gICAgICAgIHZhciB1c2VybmFtZVZhbCA9IHNpZ251cEdyb3VwLmZpbmQoJ2lucHV0W25hbWU9XCJ1c2VybmFtZVwiXScpLnZhbCgpO1xuICAgICAgICB2YXIgcGFzc3dvcmQxVmFsID0gc2lnbnVwR3JvdXAuZmluZCgnaW5wdXRbbmFtZT1cInBhc3N3b3JkMVwiXScpLnZhbCgpO1xuICAgICAgICB2YXIgcGFzc3dvcmQyVmFsID0gc2lnbnVwR3JvdXAuZmluZCgnaW5wdXRbbmFtZT1cInBhc3N3b3JkMlwiXScpLnZhbCgpO1xuICAgICAgICB2YXIgaW1nX2NhcHRjaGFWYWwgPSBzaWdudXBHcm91cC5maW5kKCdpbnB1dFtuYW1lPVwiaW1nX2NhcHRjaGFcIl0nKS52YWwoKTtcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhVmFsID0gc2lnbnVwR3JvdXAuZmluZCgnaW5wdXRbbmFtZT1cInNtc19jYXB0Y2hhXCJdJykudmFsKCk7XG5cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lVmFsLFxuICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWVWYWwsXG4gICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxVmFsLFxuICAgICAgICAgICAgJ3Bhc3N3b3JkMic6IHBhc3N3b3JkMlZhbCxcbiAgICAgICAgICAgICdpbWdfY2FwdGNoYSc6IGltZ19jYXB0Y2hhVmFsLFxuICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFWYWxcbiAgICAgICAgfTtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnL2FjY291bnQvcmVnaXN0ZXIvJyxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAvLyBoZWFkZXJzOiB7XG4gICAgICAgICAgICAvLyAgICAnWC1DU1JGVG9rZW4nOiBnZXRDb29raWUoJ2NzcmZ0b2tlbicpXG4gICAgICAgICAgICAvLyB9LFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfms6jlhozmiJDlip8hJyk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqID0gcmVzWydtZXNzYWdlJ107XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnT2JqZSA9PT0gJ3N0cmluZycgfHwgbWVzc2FnZU9iai5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3cobWVzc2FnZU9iaik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBtZXNzYWdlT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBtZXNzYWdlT2JqW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IG1lc3NhZ2VzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pXG59O1xuXG4vLyDlpITnkIZob3ZlcuWHuuadpeeahOWvvOiIquadoVxuZnVuY3Rpb24gRnJvbnRCYXNlKCkge1xuXG59XG5cbkZyb250QmFzZS5wcm90b3R5cGUubGlzdGVuQXV0aEJveEhvdmVyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhdXRoQm94ID0gJCgnLmF1dGgtYm94Jyk7XG4gICAgdmFyIHVzZXJNb3JlQm94ID0gJCgnLnVzZXItbW9yZS1ib3gnKTtcblxuICAgIGF1dGhCb3guaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICB1c2VyTW9yZUJveC5zaG93KCk7XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICB1c2VyTW9yZUJveC5oaWRlKCk7XG4gICAgfSk7XG59O1xuXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB0aGF0Lmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xuICB0aGF0Lmxpc3RlblN3aXRjaEJvdHRvbSgpO1xufTtcblxuLy8gRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hCb3R0b20gPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAgdmFyIGluZm9OYXYgPSAkKCcjbmF2LWluZm8nKTtcbi8vICAgICB2YXIgaW5kZXggPSBpbmZvTmF2LmZpbmQoJ2xpOmZpcnN0Jyk7XG4vLyAgICAgaW5kZXguYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy9cbi8vICAgICBpbmZvTmF2LmNoaWxkcmVuKCkuY2xpY2soZnVuY3Rpb24gKCkge1xuLy8gICAgICAgICB2YXIgYnRuID0gJCh0aGlzKTtcbi8vICAgICAgICAgdmFyIHVybCA9IHtcbi8vICAgICAgICAgICAgICdpbmZvX3VybCc6ICcvJyxcbi8vICAgICAgICAgICAgICdjb3Vyc2VfdXJsJzogJy9jb3Vyc2UvJyxcbi8vICAgICAgICAgICAgICdwYXlpbmZvX3VybCc6ICcvcGF5aW5mby8nLFxuLy8gICAgICAgICAgICAgJ3NlYXJjaF91cmwnOiAnL3NlYXJjaC8nXG4vLyAgICAgICAgIH07XG4vLyAgICAgICAgIHZhciBjdXJyZW50VXJsID0gYnRuLmF0dHIoJ2hyZWYnKTtcbi8vICAgICAgICAgaWYgKGN1cnJlbnRVcmwgPT09IHVybC5pbmZvX3VybCkge1xuLy8gICAgICAgICAgICAgaW5kZXgucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgYnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgIC8vIGJ0bi5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgfSBlbHNlIGlmKGN1cnJlbnRVcmw9PT11cmwuY291cnNlX3VybCkge1xuLy8gICAgICAgICAgICAgaW5kZXgucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgYnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgIC8vIGJ0bi5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50VXJsPT09dXJsLnBheWluZm9fdXJsKSB7XG4vLyAgICAgICAgICAgICBpbmRleC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgLy8gYnRuLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgaW5kZXgucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgYnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgIC8vIGJ0bi5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgfVxuLy8gICAgIH0pXG4vLyB9O1xuXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlblN3aXRjaEJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyAkKFwiI25hdi1pbmZvIGFcIikubW91c2VvdmVyKGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICB2YXIgbGVmdCA9ICQodGhpcykub2Zmc2V0KCkubGVmdCAtICQoXCIjbmF2LWluZm9cIikub2Zmc2V0KCkubGVmdDtcbiAgICAvLyAgICAgdmFyIGZseSA9ICQoXCIja295b3pcIik7XG4gICAgLy8gICAgIGlmIChmbHkuaXMoXCI6YW5pbWF0ZWRcIikpIHtcbiAgICAvLyAgICAgICAgIGZseS5zdG9wKCk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgZmx5LmFuaW1hdGUoe1xuICAgIC8vICAgICAgICAgbWFyZ2luTGVmdDpsZWZ0XG4gICAgLy8gICAgIH0sIDUwMCk7XG4gICAgLy8gfSlcbn07XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBhdXRoID0gbmV3IEF1dGgoKTtcbiAgICBhdXRoLnJ1bigpO1xufSk7XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XG4gICAgZnJvbnRCYXNlLnJ1bigpO1xufSk7XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgaWYgKHdpbmRvdy50ZW1wbGF0ZSkge1xuICAgICAgIHRlbXBsYXRlLmRlZmF1bHRzLmltcG9ydHMudGltZVNpbmNlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIC8vIGFydF90ZW1wbGF0Zeaooeadv+i/h+a7pOWZqO+8jOagvOW8j+WMluaXtumXtFxuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpO1xuICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xuICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKSAvIDEwMDA7IC8v5b6X5Yiw5Lik6ICF55u45beu55qE5pe26Ze05oiz77yM5Y2V5L2N5Li656eSXG5cbiAgICAgICAgaWYgKHRpbWVzdGFtcCA8IDYwKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBcIuWImuWImlwiXG4gICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwKjYwKSB7XG4gICAgICAgICAgICB2YXIgbWludXRlcyA9IHBhcnNlSW50KHRpbWVzdGFtcC82MCk7XG5cbiAgICAgICAgICAgIHJldHVybiBtaW51dGVzICsgJ+WIhumSn+WJjSdcbiAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAqNjAgJiYgdGltZXN0YW1wIDwgNjAqNjAqMjQpIHtcbiAgICAgICAgICAgIHZhciBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcC82MC82MCk7XG5cbiAgICAgICAgICAgIHJldHVybiBob3VycyArICflsI/ml7bliY0nXG4gICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwKjYwKjI0ICYmIHRpbWVzdGFtcCA8IDYwKjYwKjI0KjMwKSB7XG4gICAgICAgICAgICB2YXIgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcC82MC82MC8yNCk7XG4gICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERheSgpO1xuICAgICAgICAgICAgdmFyIGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7XG4gICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XG5cbiAgICAgICAgICAgIHJldHVybiB5ZWFyICsgJy8nICsgbW9udGggKyAnLycgKyBkYXkgKyAnICcgKyBob3VyICsgJzonICsgbWludXRlXG4gICAgICAgIH1cbiAgICB9O1xuICAgfVxufSk7XG4iXX0=
